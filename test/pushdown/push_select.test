#

env_open E0 "cluster_shards": 3
connect E0 S0

# test: select from table
create table test (id int primary key, data int default 0)
insert into test (id) values (1), (2), (3)

explain select * from test
select * from test

# test: select from table where
explain select * from test where id > 1
select * from test where id > 1
select * from test where id > 2
select * from test where id > 3

# test: select from table where point lookup
explain select * from test where id = 1
select * from test where id = 1
select * from test where id = 2
select * from test where id = 3
select * from test where id = 4
select * from test where id = 0

# test: select (select expr) from table
explain select (select test.*) from test
select (select test.*) from test

# test: select (select (select expr)) from table
explain select (select (select (test.*))) from test
select (select (select (test.*))) from test

# test: select (select (select from expr)) from table
explain select (select (select * from [1,2,3])) from test
select (select (select * from [1,2,3])) from test

# test: select (select (select from table)) from table
explain select (select (select * from test t)) from test

# test: select (select (select from reference)) from table
create table ref (id int primary key, data int default 0) reference
insert into ref (id) values (1), (2), (3)
explain select (select (select * from ref)) from test
select (select (select * from ref)) from test

# test: select from table where (select from expr)
explain select * from test where (select * from [1,2,3])
select * from test where (select * from [1,2,3])

# test: select from table where (select from table)
explain select * from test where (select * from test t)

# test: select from table where (select from reference)
explain select * from test where (select * from ref)
select * from test where (select * from ref)

# test: select from table, expr
explain select test.*, t.* from test, [1,2,3] t
select test.*, t.* from test, [1,2,3] t

# test: select from expr, table
explain select test.*, t.* from [1,2,3] t, test
select test.*, t.* from [1,2,3] t, test

# test: select from table, reference
explain select test.*, ref.* from test, ref
select test.*, ref.* from test, ref

# test: select from reference, table
explain select test.*, ref.* from ref, test
select test.*, ref.* from ref, test

# test: select from table, table
explain select t.* from test, test t
select t.* from test, test t

drop table ref
drop table test

disconnect S0
env_close E0
