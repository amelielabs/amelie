#

open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }], "backends": 3
connect E0 S0 localhost:3485

create shared table ref (id int primary key, data int default 0)
insert into ref (id) values (1), (2), (3)

create table test (id int primary key, data int default 0)
insert into test (id) values (1), (2), (3)

# test: select from table, shared
explain select test.*, ref.* from test, ref
select test.*, ref.* from test, ref

# test: select from shared, table
explain select test.*, ref.* from ref, test
select test.*, ref.* from ref, test

# test: select from table, table
explain select t.* from test, test t
select t.* from test, test t

# test: select from table join shared
explain select test.id, ref.id from test join ref on true
select test.id, ref.id from test join ref on true

# test: select from table join shared on
explain select test.id, ref.id from test join ref on test.id = ref.id
select test.id, ref.id from test join ref on test.id = ref.id

# test: select from table join shared on #2
explain select test.id, ref.id from test join ref on test.id = ref.id join ref ref2 on test.id = ref2.id
select test.id, ref.id from test join ref on test.id = ref.id join ref ref2 on test.id = ref2.id

# test: select from table join shared on #3
explain select test.id, ref.id from test join ref on test.id = ref.id join ref ref2 on test.id = ref2.id where test.id > 0
select test.id, ref.id from test join ref on test.id = ref.id join ref ref2 on test.id = ref2.id where test.id > 0

# test: select from table join shared on #4
explain select test.id, ref.id from test, ref where test.id = ref.id
select test.id, ref.id from test, ref where test.id = ref.id

explain select test.id, ref.id from test, ref where ref.id = test.id
select test.id, ref.id from test, ref where ref.id = test.id

explain select test.id, ref.id from test, ref where ref.id = 1
select test.id, ref.id from test, ref where ref.id = 1

explain select test.id, ref.id from test, ref where ref.id = 1 and test.id = 1
select test.id, ref.id from test, ref where ref.id = 1 and test.id = 1

explain select test.id, ref.id from test, ref where ref.id >= test.id
select test.id, ref.id from test, ref where ref.id >= test.id

# test: select from table join using
explain select test.id, ref.id from test join ref using
explain select test.id, ref.id from test join ref using(
explain select test.id, ref.id from test join ref using(1
explain select test.id, ref.id from test join ref using(id

explain select test.id, ref.id from test join ref using(id)
select test.id, ref.id from test join ref using(id)

# test: select from table join using (not found)
select test.id, ref.id from test join ref using(unknown)

# test: select from table join using #2
explain select test.id, ref.id from test join ref using (id) join ref ref2 using (id) where test.id > 0
select test.id, ref.id from test join ref using (id) join ref ref2 using (id) where test.id > 0

select test.id, ref.id from test join ref using (id) join ref ref2 using (id2) where test.id > 0

drop table ref
drop table test

disconnect S0
close E0
