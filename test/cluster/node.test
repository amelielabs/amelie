#

open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3480 }], "shards": 0
connect E0 S0 localhost:3480

# test: bootstrap (no nodes)
show nodes

# test: ddl (without nodes)
create table test (id int primary key)
create table test (id int primary key) reference
select * from test
select * from [1,2,3]

# test: create node statement parsing
create node
create node 1
create node for
create node for 1

# test: create node id
create node "" for compute
create node "00000000-0000-0000-0000-000000000000" for compute
show nodes

# test: create node already exists
create node "00000000-0000-0000-0000-000000000000" for compute

# test: create node if not exists
create node if "00000000-0000-0000-0000-000000000000" for compute
create node if
create node if not
create node if not exists
create node if not exists "00000000-0000-0000-0000-000000000000" for compute
show nodes

# test: ddl/dml (with one node)
create table test1 (id int primary key)
create table test2 (id int primary key) reference
show tables

insert into test1 values (1), (2), (3); insert into test2 4,5,6
select * from test1
select * from test2

# test: restart
disconnect S0
close E0

open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3480 }], "shards": 0
connect E0 S0 localhost:3480

show nodes
select * from test1
select * from test2

# test: drop node statement parsing
drop node
drop node 1
drop node ""

# test: drop node if exists
drop node "00000000-0000-0000-0000-000000000001"
drop node if exists "00000000-0000-0000-0000-000000000001"
show nodes

# test: drop node with dependency
drop node "00000000-0000-0000-0000-000000000000"

# test: drop node without dependency
create node "00000000-0000-0000-0000-000000000001" for compute
create node "00000000-0000-0000-0000-000000000002" for compute

show nodes
drop node "00000000-0000-0000-0000-000000000001"
show nodes

drop node "00000000-0000-0000-0000-000000000001"
drop node if exists "00000000-0000-0000-0000-000000000001"

# test: ddl (two nodes partitioning)
create table test3 (id int primary key)
show tables

# test: drop node (after table drop)
drop node "00000000-0000-0000-0000-000000000002"
drop table test3
drop node "00000000-0000-0000-0000-000000000002"
show nodes

disconnect S0
close E0
