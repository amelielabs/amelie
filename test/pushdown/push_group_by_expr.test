#

env_open E0 "cluster_shards": 3
connect E0 S0

# test: select from expr group by
explain select * from [0,1,2,3,4] group by *
select * from [0,1,2,3,4] group by *

# test: select expr from expr group by
explain select 100 + * from [0,1,2,3,4] group by *
select 100 + *[0] from [0,1,2,3,4] group by *

# test: select from (select from expr group by)
explain select * from (select * from [0,1,2,3,4] group by *)
select * from (select * from [0,1,2,3,4] group by *)

# test: select from expr group by limit
explain select * from [0,1,2,3,4] group by * limit 1
select * from [0,1,2,3,4] group by * limit 2
select * from [0,1,2,3,4] group by * limit 3
select * from [0,1,2,3,4] group by * limit 4

# test: select from expr group by limit/offset
explain select * from [0,1,2,3,4] group by * limit 1 offset 1
select * from [0,1,2,3,4] group by * limit 1 offset 0
select * from [0,1,2,3,4] group by * limit 1 offset 1
select * from [0,1,2,3,4] group by * limit 1 offset 2
select * from [0,1,2,3,4] group by * limit 1 offset 3

# test: select from expr group by offset
explain select * from [0,1,2,3,4] group by * offset 1
select * from [0,1,2,3,4] group by * offset 0
select * from [0,1,2,3,4] group by * offset 1
select * from [0,1,2,3,4] group by * offset 2
select * from [0,1,2,3,4] group by * offset 3

# test: select from (select from expr group by limit)
explain select * from (select * from [0,1,2,3,4] group by * limit 1)
select * from (select * from [0,1,2,3,4] group by * limit 2)
select * from (select * from [0,1,2,3,4] group by * limit 3)
select * from (select * from [0,1,2,3,4] group by * limit 4)

# test: select from (select from expr group by limit/offset)
explain select * from (select * from [0,1,2,3,4] group by * limit 1 offset 1)
select * from (select * from [0,1,2,3,4] group by * limit 1 offset 0)
select * from (select * from [0,1,2,3,4] group by * limit 1 offset 1)
select * from (select * from [0,1,2,3,4] group by * limit 1 offset 2)
select * from (select * from [0,1,2,3,4] group by * limit 1 offset 3)

# test: select from (select from expr group by offset)
explain select * from (select * from [0,1,2,3,4] group by * offset 1)
select * from (select * from [0,1,2,3,4] group by * offset 0)
select * from (select * from [0,1,2,3,4] group by * offset 1)
select * from (select * from [0,1,2,3,4] group by * offset 2)
select * from (select * from [0,1,2,3,4] group by * offset 3)

# test: select from table group by having
explain select * from [0,1,2,3,4] group by * having *[0] >= 3
select * from [0,1,2,3,4] group by * having *[0] >= 3
select * from [0,1,2,3,4] group by * having *[0] = 0
select * from [0,1,2,3,4] group by * having *[0] = 1
select * from [0,1,2,3,4] group by * having *[0] = 2
select * from [0,1,2,3,4] group by * having *[0] = 3
select * from [0,1,2,3,4] group by * having *[0] = 4
select * from [0,1,2,3,4] group by * having *[0] = 5
select * from [0,1,2,3,4] group by * having *[0] >= 1 and *[0] <= 3

# test: select from table group by having limit
explain select * from [0,1,2,3,4] group by * having *[0] >= 1 limit 1
select * from [0,1,2,3,4] group by * having *[0] >= 1 limit 1
select * from [0,1,2,3,4] group by * having *[0] >= 1 limit 2

# test: select from table group by having limit/offset
explain select * from [0,1,2,3,4] group by * having *[0] >= 1 limit 1 offset 1
select * from [0,1,2,3,4] group by * having *[0] >= 1 limit 1 offset 1
select * from [0,1,2,3,4] group by * having *[0] >= 1 limit 1 offset 2
select * from [0,1,2,3,4] group by * having *[0] >= 1 limit 1 offset 3

# test: select from table group by having offset
explain select * from [0,1,2,3,4] group by * having *[0] >= 1 offset 1
select * from [0,1,2,3,4] group by * having *[0] >= 1 offset 1
select * from [0,1,2,3,4] group by * having *[0] >= 1 offset 2
select * from [0,1,2,3,4] group by * having *[0] >= 1 offset 3

disconnect S0
env_close E0
