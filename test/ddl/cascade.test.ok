open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }]
connect E0 S0 localhost:3485
# test: drop schema with dependency
create schema test
create table test.a(id int primary key)
create table test.b(id int primary key)
drop schema test
{"msg": "table 'a' depends on schema 'test"}
select system.tables().'test.a'.name
["a"]
select system.tables().'test.b'.name
["b"]
create view test.test_view as select 1
select system.views()
[{
  "test.test_view": {
    "schema": "test",
    "name": "test_view",
    "query": "select 1",
    "columns": []
  }
}]
# test: drop schema cascade
drop schema test cascade
select system.schemas()
[{
  "system": {
    "name": "system",
    "system": true
  },
  "public": {
    "name": "public",
    "system": true
  }
}]
# test: drop schema cascade (tables)
select system.tables().'test.a'.name
{"msg": "[]: object key 'test.a' not found"}
select system.tables().'test.b'.name
{"msg": "[]: object key 'test.b' not found"}
# test: drop schema cascade (views)
select system.views()
[{}]
create schema test
create table test.a(id int primary key)
create table test.b(id int primary key)
drop schema test cascade
select system.tables().'test.a'.name
{"msg": "[]: object key 'test.a' not found"}
select system.tables().'test.b'.name
{"msg": "[]: object key 'test.b' not found"}
# test: alter schema rename
create schema test
create table test.a(id int primary key)
create table test.b(id int primary key)
select system.schemas()
[{
  "system": {
    "name": "system",
    "system": true
  },
  "public": {
    "name": "public",
    "system": true
  },
  "test": {
    "name": "test",
    "system": false
  }
}]
select system.tables().'test.a'.name
["a"]
select system.tables().'test.b'.name
["b"]
alter schema test rename test2
select system.schemas()
[{
  "system": {
    "name": "system",
    "system": true
  },
  "public": {
    "name": "public",
    "system": true
  },
  "test2": {
    "name": "test2",
    "system": false
  }
}]
select system.tables().'test2.a'.name
["a"]
select system.tables().'test2.b'.name
["b"]
disconnect S0
close E0
