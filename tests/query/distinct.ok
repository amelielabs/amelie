open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }];
connect E0 S0 127.0.0.1:3485;
# test: select distinct from expr
select distinct it from ([1,2,3,1,2]) it;
[1, 2, 3]
# test: select count(distinct) from expr
explain select count(distinct it) from ([1,2,3]) it;
[{
  "main": {
    "00": "set_ordered         0      1      1     ",
    "01": "set_ordered         1      0      3     ",
    "02": "set_assign          0      1      0     ",
    "03": "json                1      4      0     ",
    "04": "json_open           2      1      11    ",
    "05": "push_bool           1      0      0     ",
    "06": "set_get             3      0      0     ",
    "07": "json_read           4      2      0     ",
    "08": "push                4      0      0     ",
    "09": "set_agg             0      3      9     ",
    "10": "json_next           2      5      0     ",
    "11": "free                1      0      0     ",
    "12": "push_bool           1      0      0     ",
    "13": "set_get             1      0      0     ",
    "14": "push_nulls          1      0      0     ",
    "15": "set_agg             0      1      9     ",
    "16": "set_sort            0      0      0     ",
    "17": "union_aggs          1      0      9     ",
    "18": "set                 0      1      0     ",
    "19": "store_open          2      1      24    ",
    "20": "count               3      2      0     ",
    "21": "push                3      0      0     ",
    "22": "set_add             0      0      0     ",
    "23": "store_next          2      20     0     ",
    "24": "free                2      0      0     ",
    "25": "free                1      0      0     ",
    "26": "ret                 0      0      -     "
  },
  "access": []
}]
select count(it) from ([1,2,3]) it;
[3]
select count(distinct it) from ([1,2,3]) it;
[3]
select count(it) from ([1,2,3,3]) it;
[4]
select count(distinct it) from ([1,2,3,3]) it;
[3]
select count(it) from ([1,2,3,1]) it;
[4]
select count(distinct it) from ([1,2,3,1]) it;
[3]
select count(it) from ([1,2,3,1,2]) it;
[5]
select count(distinct it) from ([1,2,3,1,2]) it;
[3]
# test: select count(distinct) from expr group by
explain select count(distinct it) from ([1,2,3]) it group by it;
[{
  "main": {
    "00": "set_ordered         0      1      1     ",
    "01": "set_ordered         1      0      3     ",
    "02": "set_assign          0      1      0     ",
    "03": "json                1      4      0     ",
    "04": "json_open           2      1      12    ",
    "05": "json_read           3      2      0     ",
    "06": "push                3      0      0     ",
    "07": "set_get             3      0      0     ",
    "08": "json_read           4      2      0     ",
    "09": "push                4      0      0     ",
    "10": "set_agg             0      3      9     ",
    "11": "json_next           2      5      0     ",
    "12": "free                1      0      0     ",
    "13": "set_sort            0      0      0     ",
    "14": "union_aggs          1      0      9     ",
    "15": "set                 0      1      0     ",
    "16": "store_open          2      1      21    ",
    "17": "count               3      2      0     ",
    "18": "push                3      0      0     ",
    "19": "set_add             0      0      0     ",
    "20": "store_next          2      17     0     ",
    "21": "free                2      0      0     ",
    "22": "free                1      0      0     ",
    "23": "ret                 0      0      -     "
  },
  "access": []
}]
select count(it) from ([1,2,3]) it group by it;
[1, 1, 1]
select count(distinct it) from ([1,2,3]) it group by it;
[1, 1, 1]
select count(it) from ([1,2,3]) it group by it;
[1, 1, 1]
select count(distinct it) from ([1,2,3]) it group by it;
[1, 1, 1]
select count(it) from ([1,2,3,3]) it group by it;
[1, 1, 2]
select count(distinct it) from ([1,2,3,3]) it group by it;
[1, 1, 1]
select count(it) from ([1,2,3,1]) it group by it;
[2, 1, 1]
select count(distinct it) from ([1,2,3,1]) it group by it;
[1, 1, 1]
select count(it) from ([1,2,3,1,2]) it group by it;
[2, 2, 1]
select count(distinct it) from ([1,2,3,1,2]) it group by it;
[1, 1, 1]
select it, count(distinct it) from ([1,2,3,1,2]) it group by it;
[[1, 1], [2, 1], [3, 1]]
# test: select count(distinct) from expr group by order by
explain select count(distinct it) from ([1,2,3]) it group by it order by 1;
[{
  "main": {
    "00": "set_ordered         0      1      1     ",
    "01": "set_ordered         1      0      3     ",
    "02": "set_assign          0      1      0     ",
    "03": "json                1      4      0     ",
    "04": "json_open           2      1      12    ",
    "05": "json_read           3      2      0     ",
    "06": "push                3      0      0     ",
    "07": "set_get             3      0      0     ",
    "08": "json_read           4      2      0     ",
    "09": "push                4      0      0     ",
    "10": "set_agg             0      3      9     ",
    "11": "json_next           2      5      0     ",
    "12": "free                1      0      0     ",
    "13": "set_sort            0      0      0     ",
    "14": "union_aggs          1      0      9     ",
    "15": "set_ordered         0      1      1     ",
    "16": "store_open          2      1      23    ",
    "17": "count               3      2      0     ",
    "18": "push                3      0      0     ",
    "19": "count               3      2      0     ",
    "20": "push                3      0      0     ",
    "21": "set_add             0      0      0     ",
    "22": "store_next          2      17     0     ",
    "23": "free                2      0      0     ",
    "24": "free                1      0      0     ",
    "25": "set_sort            0      0      0     ",
    "26": "union               1      0      0     ",
    "27": "ret                 1      0      -     "
  },
  "access": []
}]
select count(it) from ([1,2,3]) it group by it order by 1;
[1, 1, 1]
select count(distinct it) from ([1,2,3]) it group by it order by 1;
[1, 1, 1]
select count(it) from ([1,2,3]) it group by it order by 1;
[1, 1, 1]
select count(distinct it) from ([1,2,3]) it group by it order by 1;
[1, 1, 1]
select count(it) from ([1,2,3,3]) it group by it order by 1;
[1, 1, 2]
select count(distinct it) from ([1,2,3,3]) it group by it order by 1;
[1, 1, 1]
select count(it) from ([1,2,3,1]) it group by it order by 1;
[1, 1, 2]
select count(distinct it) from ([1,2,3,1]) it group by it order by 1;
[1, 1, 1]
select count(it) from ([1,2,3,1,2]) it group by it order by 1;
[1, 2, 2]
select count(distinct it) from ([1,2,3,1,2]) it group by it order by 1;
[1, 1, 1]
select it, count(it) from ([1,2,3,1,2]) it group by it order by 2;
[[3, 1], [1, 2], [2, 2]]
select it, count(distinct it) from ([1,2,3,1,2]) it group by it order by 2;
[[1, 1], [2, 1], [3, 1]]
# test: select count(distinct) from expr order by
explain select count(distinct it) from ([1,2,3]) it order by 1;
[{
  "main": {
    "00": "set_ordered         0      1      1     ",
    "01": "set_ordered         1      0      3     ",
    "02": "set_assign          0      1      0     ",
    "03": "json                1      4      0     ",
    "04": "json_open           2      1      11    ",
    "05": "push_bool           1      0      0     ",
    "06": "set_get             3      0      0     ",
    "07": "json_read           4      2      0     ",
    "08": "push                4      0      0     ",
    "09": "set_agg             0      3      9     ",
    "10": "json_next           2      5      0     ",
    "11": "free                1      0      0     ",
    "12": "push_bool           1      0      0     ",
    "13": "set_get             1      0      0     ",
    "14": "push_nulls          1      0      0     ",
    "15": "set_agg             0      1      9     ",
    "16": "set_sort            0      0      0     ",
    "17": "union_aggs          1      0      9     ",
    "18": "set_ordered         0      1      1     ",
    "19": "store_open          2      1      26    ",
    "20": "count               3      2      0     ",
    "21": "push                3      0      0     ",
    "22": "count               3      2      0     ",
    "23": "push                3      0      0     ",
    "24": "set_add             0      0      0     ",
    "25": "store_next          2      20     0     ",
    "26": "free                2      0      0     ",
    "27": "free                1      0      0     ",
    "28": "set_sort            0      0      0     ",
    "29": "union               1      0      0     ",
    "30": "ret                 1      0      -     "
  },
  "access": []
}]
select count(it) from ([1,2,3,1,2]) it order by 1;
[5]
select count(distinct it) from ([1,2,3,1,2]) it order by 1;
[3]
# test: select (select count(distinct))
select (select count(distinct it) from ([1,2,3,1,2]) it);
[3]
# test: select (select count(distinct) group by)
explain select (select count(distinct it) from ([1,2,3,1,2]) it group by it);
[{
  "main": {
    "00": "set_ordered         0      1      1     ",
    "01": "set_ordered         1      0      3     ",
    "02": "set_assign          0      1      0     ",
    "03": "json                1      4      0     ",
    "04": "json_open           2      1      12    ",
    "05": "json_read           3      2      0     ",
    "06": "push                3      0      0     ",
    "07": "set_get             3      0      0     ",
    "08": "json_read           4      2      0     ",
    "09": "push                4      0      0     ",
    "10": "set_agg             0      3      11    ",
    "11": "json_next           2      5      0     ",
    "12": "free                1      0      0     ",
    "13": "set_sort            0      0      0     ",
    "14": "union_aggs          1      0      11    ",
    "15": "set                 0      1      0     ",
    "16": "store_open          2      1      21    ",
    "17": "count               3      2      0     ",
    "18": "push                3      0      0     ",
    "19": "set_add             0      0      0     ",
    "20": "store_next          2      17     0     ",
    "21": "free                2      0      0     ",
    "22": "free                1      0      0     ",
    "23": "first               1      0      0     ",
    "24": "ret                 1      0      -     "
  },
  "access": []
}]
select (select count(distinct it) from ([1,2,3,1,2]) it group by it);
[1]
# test: select (select distinct)
explain select (select distinct it from ([1,2,3,1,2]) it);
[{
  "main": {
    "00": "set_ordered         0      1      1     ",
    "01": "json                1      1      0     ",
    "02": "json_open           2      1      9     ",
    "03": "json_read           3      2      0     ",
    "04": "push                3      0      0     ",
    "05": "json_read           3      2      0     ",
    "06": "push                3      0      0     ",
    "07": "set_add             0      0      0     ",
    "08": "json_next           2      3      0     ",
    "09": "free                1      0      0     ",
    "10": "set_sort            0      0      0     ",
    "11": "union               1      0      1     ",
    "12": "first               0      1      0     ",
    "13": "ret                 0      0      -     "
  },
  "access": []
}]
select (select distinct it from ([1,2,3,1,2]) it);
[1]
disconnect S0;
close E0;
