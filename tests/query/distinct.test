#

open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }];
connect E0 S0 127.0.0.1:3485;

# test: select distinct from expr
explain select distinct it from ([1,2,3,1,2]) it;
select distinct it from ([1,2,3,1,2]) it;

# test: select count(all) from expr
select count(all *) from ([1,2,3]) it;
select count(all it) from ([1,2,3]) it;
select count(it) from ([1,2,3]) it;

# test: select count(distinct) from expr
explain select count(distinct it) from ([1,2,3]) it;

select count(it) from ([1,2,3]) it;
select count(distinct it) from ([1,2,3]) it;

select count(it) from ([1,2,3,3]) it;
select count(distinct it) from ([1,2,3,3]) it;

select count(it) from ([1,2,3,1]) it;
select count(distinct it) from ([1,2,3,1]) it;

select count(it) from ([1,2,3,1,2]) it;
select count(distinct it) from ([1,2,3,1,2]) it;

# test: select count(distinct) from expr group by
explain select count(distinct it) from ([1,2,3]) it group by it;

select count(it) from ([1,2,3]) it group by it;
select count(distinct it) from ([1,2,3]) it group by it;

select count(it) from ([1,2,3]) it group by it;
select count(distinct it) from ([1,2,3]) it group by it;

select count(it) from ([1,2,3,3]) it group by it;
select count(distinct it) from ([1,2,3,3]) it group by it;

select count(it) from ([1,2,3,1]) it group by it;
select count(distinct it) from ([1,2,3,1]) it group by it;

select count(it) from ([1,2,3,1,2]) it group by it;
select count(distinct it) from ([1,2,3,1,2]) it group by it;
select it, count(distinct it) from ([1,2,3,1,2]) it group by it;

# test: select count(distinct) from expr group by order by
explain select count(distinct it) from ([1,2,3]) it group by it order by 1;

select count(it) from ([1,2,3]) it group by it order by 1;
select count(distinct it) from ([1,2,3]) it group by it order by 1;

select count(it) from ([1,2,3]) it group by it order by 1;
select count(distinct it) from ([1,2,3]) it group by it order by 1;

select count(it) from ([1,2,3,3]) it group by it order by 1;
select count(distinct it) from ([1,2,3,3]) it group by it order by 1;

select count(it) from ([1,2,3,1]) it group by it order by 1;
select count(distinct it) from ([1,2,3,1]) it group by it order by 1;

select count(it) from ([1,2,3,1,2]) it group by it order by 1;
select count(distinct it) from ([1,2,3,1,2]) it group by it order by 1;

select it, count(it) from ([1,2,3,1,2]) it group by it order by 2;
select it, count(distinct it) from ([1,2,3,1,2]) it group by it order by 2;

# test: select count(distinct) from expr order by
explain select count(distinct it) from ([1,2,3]) it order by 1;
select count(it) from ([1,2,3,1,2]) it order by 1;
select count(distinct it) from ([1,2,3,1,2]) it order by 1;

# test: select count(distinct) from expr group by
explain select count(distinct it) from ([1,2,3]) it group by it;

# test: select (select count(distinct))
select (select count(distinct it) from ([1,2,3,1,2]) it);

# test: select (select count(distinct) group by)
explain select (select count(distinct it) from ([1,2,3,1,2]) it group by it);
select (select count(distinct it) from ([1,2,3,1,2]) it group by it);

# test: select (select distinct)
explain select (select distinct it from ([1,2,3,1,2]) it);
select (select distinct it from ([1,2,3,1,2]) it);

# test: select sum(all) from expr
select sum(it::int) from ([1,2,3,3,1]) it;
select sum(all it::int) from ([1,2,3,3,1]) it;

# test: select sum(distinct) from expr
explain select sum(distinct it::int) from ([1,2,3,3,1]) it;
select sum(distinct it::int) from ([1,2,3,3,1]) it;

explain select sum(distinct it::double) from ([1,2,3,3,1]) it;
select sum(distinct it::double) from ([1,2,3,3,1]) it;

# test: select sum(distinct) from expr group by
explain select sum(it::int) from ([1,2,3,3,1]) it group by it;
select sum(it::int) from ([1,2,3,3,1]) it group by it;

explain select sum(distinct it::int) from ([1,2,3,3,1]) it group by it;
select sum(distinct it::int) from ([1,2,3,3,1]) it group by it;

# test: select sum(distinct) from expr group by order by
explain select sum(it::int) from ([1,2,3,3,1]) it group by it order by 1;
select sum(it::int) from ([1,2,3,3,1]) it group by it order by 1;

explain select sum(distinct it::int) from ([1,2,3,3,1]) it group by it order by 1;
select sum(distinct it::int) from ([1,2,3,3,1]) it group by it order by 1;

# test: select avg(all) from expr
select avg(it::int) from ([1,2,3,3,1]) it;
select avg(all it::int) from ([1,2,3,3,1]) it;

# test: select avg(distinct) from expr
explain select avg(distinct it::int) from ([1,2,3,3,1]) it;
select avg(distinct it::int) from ([1,2,3,3,1]) it;

explain select avg(distinct it::double) from ([1,2,3,3,1]) it;
select avg(distinct it::double) from ([1,2,3,3,1]) it;

# test: select avg(distinct) from expr group by
explain select avg(it::int) from ([1,2,3,3,1]) it group by it;
select avg(it::int) from ([1,2,3,3,1]) it group by it;

explain select avg(distinct it::int) from ([1,2,3,3,1]) it group by it;
select avg(distinct it::int) from ([1,2,3,3,1]) it group by it;

# test: select avg(distinct) from expr group by order by
explain select avg(it::int) from ([1,2,3,3,1]) it group by it order by 1;
select avg(it::int) from ([1,2,3,3,1]) it group by it order by 1;

explain select avg(distinct it::int) from ([1,2,3,3,1]) it group by it order by 1;
select avg(distinct it::int) from ([1,2,3,3,1]) it group by it order by 1;

# test: select min(distinct) from expr
select min(it::int) from ([1,2,3,3,1]) it;
select min(all it::int) from ([1,2,3,3,1]) it;
select min(distinct it::int) from ([1,2,3,3,1]) it;

# test: select max(distinct) from expr
select max(it::int) from ([1,2,3,3,1]) it;
select max(all it::int) from ([1,2,3,3,1]) it;
select max(distinct it::int) from ([1,2,3,3,1]) it;

disconnect S0;
close E0;
