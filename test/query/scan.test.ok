env_open E0
connect E0 S0
connect: on_connect
# test: key column
create table test (id int primary key, data int default 1)
insert into test (id) values (1), (2), (3)
explain select * from test where id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where id > 1
[2, 1]
[3, 1]
explain select * from test where id >= 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                 gte        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where id >= 1
[1, 1]
[2, 1]
[3, 1]
drop table test
# test: key column.path
create table test (obj object, primary key(obj.id int))
insert into test {"id": 1}
insert into test {"id": 2}
insert into test {"id": 3}
explain select * from test where obj.id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0      # id
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where obj.id > 1
[{"id": 2}]
[{"id": 3}]
drop table test
# test: key column.path.path
create table test (obj object, primary key(obj.data.id int))
insert into test {"data": {"id": 1}}
insert into test {"data": {"id": 2}}
insert into test {"data": {"id": 3}}
explain select * from test where obj.data.id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0      # data.id
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where obj.data.id > 1
[{"data": {"id": 2}}]
[{"data": {"id": 3}}]
drop table test
# test: key target.column
create table test (id int primary key, data int default 1)
insert into test (id) values (1), (2), (3)
explain select * from test where test.id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where test.id > 1
[2, 1]
[3, 1]
drop table test
# test: key target.column.path
create table test (obj object, primary key(obj.id int))
insert into test {"id": 1}
insert into test {"id": 2}
insert into test {"id": 3}
explain select * from test where test.obj.id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0      # id
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where test.obj.id > 1
[{"id": 2}]
[{"id": 3}]
drop table test
# test: key target.column.path.path
create table test (obj object, primary key(obj.data.id int))
insert into test {"data": {"id": 1}}
insert into test {"data": {"id": 2}}
insert into test {"data": {"id": 3}}
explain select * from test where test.obj.data.id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0      # data.id
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where test.obj.data.id > 1
[{"data": {"id": 2}}]
[{"data": {"id": 3}}]
drop table test
# test: key alias.column
create table test (id int primary key, data int default 1)
insert into test (id) values (1), (2), (3)
explain select * from test alias where alias.id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test alias where alias.id > 1
[2, 1]
[3, 1]
drop table test
# test: key alias.column.path
create table test (obj object, primary key(obj.id int))
insert into test {"id": 1}
insert into test {"id": 2}
insert into test {"id": 3}
explain select * from test alias where alias.obj.id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0      # id
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test alias where alias.obj.id > 1
[{"id": 2}]
[{"id": 3}]
drop table test
# test: key alias.column.path.path
create table test (obj object, primary key(obj.data.id int))
insert into test {"data": {"id": 1}}
insert into test {"data": {"id": 2}}
insert into test {"data": {"id": 3}}
explain select * from test alias where alias.obj.data.id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0      # data.id
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test alias where alias.obj.data.id > 1
[{"data": {"id": 2}}]
[{"data": {"id": 3}}]
drop table test
# test: key column type mismatch
create table test (id int primary key, data int default 1)
explain select * from test where id > "hello"
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0
 5              string        1     20      0      # hello
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where id > "hello"
drop table test
# test: key column type mismatch #2
create table test (id string primary key, data int default 1)
explain select * from test where id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0          string_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where id > 1
drop table test
# test: key gt (start condition)
create table test (id int primary key, data int default 1)
insert into test (id) values (1), (2), (3)
explain select * from test where id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  gt        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where id > 1
[2, 1]
[3, 1]
# test: key gt and gt (same key)
explain select * from test where id > 1 and id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       20      0      0
 4          cursor_idx        1      0      0
 5                 int        2      1      0
 6                  gt        3      1      2
 7                jntr       12      3      0
 8          cursor_idx        1      0      0
 9                 int        2      1      0
10                  gt        4      1      2
11                 jtr       14      4      0
12                bool        0      0      0
13                 jmp       15      0      0
14                bool        0      1      0
15                 nop        0      0      0
16                jntr       19      0      0
17         cursor_read        0      0      0
18                send        0      0      0
19         cursor_next        0      4      0
20        cursor_close        0      0      0
21               ready        0     -1      0
22                 ret        0      0      0

"
select * from test where id > 1 and id > 1
[2, 1]
[3, 1]
# test: key gt and gt (less)
explain select * from test where id > 2 and id > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      2      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       20      0      0
 4          cursor_idx        1      0      0
 5                 int        2      2      0
 6                  gt        3      1      2
 7                jntr       12      3      0
 8          cursor_idx        1      0      0
 9                 int        2      1      0
10                  gt        4      1      2
11                 jtr       14      4      0
12                bool        0      0      0
13                 jmp       15      0      0
14                bool        0      1      0
15                 nop        0      0      0
16                jntr       19      0      0
17         cursor_read        0      0      0
18                send        0      0      0
19         cursor_next        0      4      0
20        cursor_close        0      0      0
21               ready        0     -1      0
22                 ret        0      0      0

"
select * from test where id > 2 and id > 1
[3, 1]
# test: key gt and gt (greater)
explain select * from test where id > 1 and id > 2
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      2      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       20      0      0
 4          cursor_idx        1      0      0
 5                 int        2      1      0
 6                  gt        3      1      2
 7                jntr       12      3      0
 8          cursor_idx        1      0      0
 9                 int        2      2      0
10                  gt        4      1      2
11                 jtr       14      4      0
12                bool        0      0      0
13                 jmp       15      0      0
14                bool        0      1      0
15                 nop        0      0      0
16                jntr       19      0      0
17         cursor_read        0      0      0
18                send        0      0      0
19         cursor_next        0      4      0
20        cursor_close        0      0      0
21               ready        0     -1      0
22                 ret        0      0      0

"
select * from test where id > 1 and id > 2
[3, 1]
# test: key gt and eq (scan to point lookup)
explain select * from test where id > 1 and id = 2
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      2      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       20      0      0
 4          cursor_idx        1      0      0
 5                 int        2      1      0
 6                  gt        3      1      2
 7                jntr       12      3      0
 8          cursor_idx        1      0      0
 9                 int        2      2      0
10                 equ        4      1      2
11                 jtr       14      4      0
12                bool        0      0      0
13                 jmp       15      0      0
14                bool        0      1      0
15                 nop        0      0      0
16                jntr        3      0      0
17         cursor_read        0      0      0
18                send        0      0      0
19         cursor_next        0      4      0
20        cursor_close        0      0      0
21               ready        0     -1      0
22                 ret        0      0      0

"
select * from test where id > 1 and id = 2
[2, 1]
# test: key lt (stop condition)
explain select * from test where id < 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       15      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  lt        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        0      0      0
 9                 int        1      1      0
10                  lt        2      0      1
11                jntr       14      2      0
12         cursor_read        0      0      0
13                send        0      0      0
14         cursor_next        0      4      0
15        cursor_close        0      0      0
16               ready        0     -1      0
17                 ret        0      0      0

"
select * from test where id < 1
explain select * from test where id <= 2
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       15      0      0
 4          cursor_idx        0      0      0
 5                 int        1      2      0
 6                 lte        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        0      0      0
 9                 int        1      2      0
10                 lte        2      0      1
11                jntr       14      2      0
12         cursor_read        0      0      0
13                send        0      0      0
14         cursor_next        0      4      0
15        cursor_close        0      0      0
16               ready        0     -1      0
17                 ret        0      0      0

"
select * from test where id <= 2
[1, 1]
[2, 1]
# test: key lt and lt (same)
explain select * from test where id < 1 and id < 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       24      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  lt        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        1      0      0
 9                 int        2      1      0
10                  lt        3      1      2
11                jntr       16      3      0
12          cursor_idx        1      0      0
13                 int        2      1      0
14                  lt        4      1      2
15                 jtr       18      4      0
16                bool        0      0      0
17                 jmp       19      0      0
18                bool        0      1      0
19                 nop        0      0      0
20                jntr       23      0      0
21         cursor_read        0      0      0
22                send        0      0      0
23         cursor_next        0      4      0
24        cursor_close        0      0      0
25               ready        0     -1      0
26                 ret        0      0      0

"
select * from test where id < 1 and id < 1
# test: key lt and lt (less)
explain select * from test where id < 2 and id < 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       24      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  lt        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        1      0      0
 9                 int        2      2      0
10                  lt        3      1      2
11                jntr       16      3      0
12          cursor_idx        1      0      0
13                 int        2      1      0
14                  lt        4      1      2
15                 jtr       18      4      0
16                bool        0      0      0
17                 jmp       19      0      0
18                bool        0      1      0
19                 nop        0      0      0
20                jntr       23      0      0
21         cursor_read        0      0      0
22                send        0      0      0
23         cursor_next        0      4      0
24        cursor_close        0      0      0
25               ready        0     -1      0
26                 ret        0      0      0

"
select * from test where id < 2 and id < 1
# test: key lt and lt (greater)
explain select * from test where id < 1 and id < 2
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       24      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  lt        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        1      0      0
 9                 int        2      1      0
10                  lt        3      1      2
11                jntr       16      3      0
12          cursor_idx        1      0      0
13                 int        2      2      0
14                  lt        4      1      2
15                 jtr       18      4      0
16                bool        0      0      0
17                 jmp       19      0      0
18                bool        0      1      0
19                 nop        0      0      0
20                jntr       23      0      0
21         cursor_read        0      0      0
22                send        0      0      0
23         cursor_next        0      4      0
24        cursor_close        0      0      0
25               ready        0     -1      0
26                 ret        0      0      0

"
select * from test where id < 1 and id < 2
# test: key lt and eq (scan to point lookup)
explain select * from test where id < 1 and id = 2
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      2      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       24      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  lt        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        1      0      0
 9                 int        2      1      0
10                  lt        3      1      2
11                jntr       16      3      0
12          cursor_idx        1      0      0
13                 int        2      2      0
14                 equ        4      1      2
15                 jtr       18      4      0
16                bool        0      0      0
17                 jmp       19      0      0
18                bool        0      1      0
19                 nop        0      0      0
20                jntr        3      0      0
21         cursor_read        0      0      0
22                send        0      0      0
23         cursor_next        0      4      0
24        cursor_close        0      0      0
25               ready        0     -1      0
26                 ret        0      0      0

"
select * from test where id < 1 and id = 2
# test: key gt and lt
explain select * from test where id > 1 and id < 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       24      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  lt        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        1      0      0
 9                 int        2      1      0
10                  gt        3      1      2
11                jntr       16      3      0
12          cursor_idx        1      0      0
13                 int        2      1      0
14                  lt        4      1      2
15                 jtr       18      4      0
16                bool        0      0      0
17                 jmp       19      0      0
18                bool        0      1      0
19                 nop        0      0      0
20                jntr       23      0      0
21         cursor_read        0      0      0
22                send        0      0      0
23         cursor_next        0      4      0
24        cursor_close        0      0      0
25               ready        0     -1      0
26                 ret        0      0      0

"
select * from test where id > 1 and id < 1
explain select * from test where id >= 1 and id <= 2
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       24      0      0
 4          cursor_idx        0      0      0
 5                 int        1      2      0
 6                 lte        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        1      0      0
 9                 int        2      1      0
10                 gte        3      1      2
11                jntr       16      3      0
12          cursor_idx        1      0      0
13                 int        2      2      0
14                 lte        4      1      2
15                 jtr       18      4      0
16                bool        0      0      0
17                 jmp       19      0      0
18                bool        0      1      0
19                 nop        0      0      0
20                jntr       23      0      0
21         cursor_read        0      0      0
22                send        0      0      0
23         cursor_next        0      4      0
24        cursor_close        0      0      0
25               ready        0     -1      0
26                 ret        0      0      0

"
select * from test where id >= 1 and id <= 2
[1, 1]
[2, 1]
# test: key gt and lt and eq
explain select * from test where id > 1 and id < 1 and id = 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       33      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  lt        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        1      0      0
 9                 int        2      1      0
10                  gt        3      1      2
11                jntr       25      3      0
12          cursor_idx        2      0      0
13                 int        4      1      0
14                  lt        5      2      4
15                jntr       20      5      0
16          cursor_idx        2      0      0
17                 int        4      1      0
18                 equ        6      2      4
19                 jtr       22      6      0
20                bool        1      0      0
21                 jmp       23      0      0
22                bool        1      1      0
23                 nop        0      0      0
24                 jtr       27      1      0
25                bool        0      0      0
26                 jmp       28      0      0
27                bool        0      1      0
28                 nop        0      0      0
29                jntr        3      0      0
30         cursor_read        0      0      0
31                send        0      0      0
32         cursor_next        0      4      0
33        cursor_close        0      0      0
34               ready        0     -1      0
35                 ret        0      0      0

"
select * from test where id > 1 and id < 1 and id = 1
# test: key gt and lt and eq (non key)
explain select * from test where id > 1 and id < 1 and data = 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       33      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                  lt        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        1      0      0
 9                 int        2      1      0
10                  gt        3      1      2
11                jntr       25      3      0
12          cursor_idx        2      0      0
13                 int        4      1      0
14                  lt        5      2      4
15                jntr       20      5      0
16          cursor_idx        2      0      1
17                 int        4      1      0
18                 equ        6      2      4
19                 jtr       22      6      0
20                bool        1      0      0
21                 jmp       23      0      0
22                bool        1      1      0
23                 nop        0      0      0
24                 jtr       27      1      0
25                bool        0      0      0
26                 jmp       28      0      0
27                bool        0      1      0
28                 nop        0      0      0
29                jntr       32      0      0
30         cursor_read        0      0      0
31                send        0      0      0
32         cursor_next        0      4      0
33        cursor_close        0      0      0
34               ready        0     -1      0
35                 ret        0      0      0

"
select * from test where id > 1 and id < 1 and data = 1
# test: key eq (start condition)
explain select * from test where id = 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      0
 5                 int        1      1      0
 6                 equ        2      0      1
 7                jntr        3      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where id = 0
select * from test where id = 1
[1, 1]
select * from test where id = 2
[2, 1]
select * from test where id = 3
[3, 1]
select * from test where id = 4
# test: key eq (non key)
explain select * from test where data = 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       11      0      0
 4          cursor_idx        0      0      1
 5                 int        1      1      0
 6                 equ        2      0      1
 7                jntr       10      2      0
 8         cursor_read        0      0      0
 9                send        0      0      0
10         cursor_next        0      4      0
11        cursor_close        0      0      0
12               ready        0     -1      0
13                 ret        0      0      0

"
select * from test where data = 1
[1, 1]
[2, 1]
[3, 1]
# test: key eq and gt
explain select * from test where id = 1 and id > 0
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       20      0      0
 4          cursor_idx        1      0      0
 5                 int        2      1      0
 6                 equ        3      1      2
 7                jntr       12      3      0
 8          cursor_idx        1      0      0
 9                 int        2      0      0
10                  gt        4      1      2
11                 jtr       14      4      0
12                bool        0      0      0
13                 jmp       15      0      0
14                bool        0      1      0
15                 nop        0      0      0
16                jntr        3      0      0
17         cursor_read        0      0      0
18                send        0      0      0
19         cursor_next        0      4      0
20        cursor_close        0      0      0
21               ready        0     -1      0
22                 ret        0      0      0

"
select * from test where id = 1 and id > 0
[1, 1]
# test: key eq and gt and lt
explain select * from test where id = 1 and id > 0 and id < 10
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       33      0      0
 4          cursor_idx        0      0      0
 5                 int        1     10      0
 6                  lt        2      0      1
 7                jntr        3      2      0
 8          cursor_idx        1      0      0
 9                 int        2      1      0
10                 equ        3      1      2
11                jntr       25      3      0
12          cursor_idx        2      0      0
13                 int        4      0      0
14                  gt        5      2      4
15                jntr       20      5      0
16          cursor_idx        2      0      0
17                 int        4     10      0
18                  lt        6      2      4
19                 jtr       22      6      0
20                bool        1      0      0
21                 jmp       23      0      0
22                bool        1      1      0
23                 nop        0      0      0
24                 jtr       27      1      0
25                bool        0      0      0
26                 jmp       28      0      0
27                bool        0      1      0
28                 nop        0      0      0
29                jntr        3      0      0
30         cursor_read        0      0      0
31                send        0      0      0
32         cursor_next        0      4      0
33        cursor_close        0      0      0
34               ready        0     -1      0
35                 ret        0      0      0

"
select * from test where id = 1 and id > 0 and id < 10
[1, 1]
# test: key eq and eq
explain select * from test where id = 1 and id = 2
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       20      0      0
 4          cursor_idx        1      0      0
 5                 int        2      1      0
 6                 equ        3      1      2
 7                jntr       12      3      0
 8          cursor_idx        1      0      0
 9                 int        2      2      0
10                 equ        4      1      2
11                 jtr       14      4      0
12                bool        0      0      0
13                 jmp       15      0      0
14                bool        0      1      0
15                 nop        0      0      0
16                jntr        3      0      0
17         cursor_read        0      0      0
18                send        0      0      0
19         cursor_next        0      4      0
20        cursor_close        0      0      0
21               ready        0     -1      0
22                 ret        0      0      0

"
select * from test where id = 1 and id = 2
drop table test
# test: key compound gt 1 (start condition)
create table test (a int, b int, primary key(a, b))
insert into test values (1, 1), (2, 2), (3, 3)
explain select * from test where a > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2             int_min        0      0      0
 3                push        0      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       13      0      0
 6          cursor_idx        0      0      0
 7                 int        1      1      0
 8                  gt        2      0      1
 9                jntr       12      2      0
10         cursor_read        0      0      0
11                send        0      0      0
12         cursor_next        0      6      0
13        cursor_close        0      0      0
14               ready        0     -1      0
15                 ret        0      0      0

"
select * from test where a > 1
[2, 2]
[3, 3]
# test: key compound gt full (start condition)
explain select * from test where a > 1 and b > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2                 int        0      1      0
 3                push        0      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       22      0      0
 6          cursor_idx        1      0      0
 7                 int        2      1      0
 8                  gt        3      1      2
 9                jntr       14      3      0
10          cursor_idx        1      0      1
11                 int        2      1      0
12                  gt        4      1      2
13                 jtr       16      4      0
14                bool        0      0      0
15                 jmp       17      0      0
16                bool        0      1      0
17                 nop        0      0      0
18                jntr       21      0      0
19         cursor_read        0      0      0
20                send        0      0      0
21         cursor_next        0      6      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0

"
select * from test where a > 1 and b > 1
[2, 2]
[3, 3]
# test: key compound gt and lt (stop condition on inner key)
explain select * from test where a > 1 and b < 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2             int_min        0      0      0
 3                push        0      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       22      0      0
 6          cursor_idx        1      0      0
 7                 int        2      1      0
 8                  gt        3      1      2
 9                jntr       14      3      0
10          cursor_idx        1      0      1
11                 int        2      1      0
12                  lt        4      1      2
13                 jtr       16      4      0
14                bool        0      0      0
15                 jmp       17      0      0
16                bool        0      1      0
17                 nop        0      0      0
18                jntr       21      0      0
19         cursor_read        0      0      0
20                send        0      0      0
21         cursor_next        0      6      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0

"
select * from test where a > 1 and b < 1
# test: key compound gt and lt and lt (stop condition on outer key)
explain select * from test where a > 1 and b < 1 and a < 10
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2             int_min        0      0      0
 3                push        0      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       35      0      0
 6          cursor_idx        0      0      0
 7                 int        1     10      0
 8                  lt        2      0      1
 9                jntr        5      2      0
10          cursor_idx        1      0      0
11                 int        2      1      0
12                  gt        3      1      2
13                jntr       27      3      0
14          cursor_idx        2      0      1
15                 int        4      1      0
16                  lt        5      2      4
17                jntr       22      5      0
18          cursor_idx        2      0      0
19                 int        4     10      0
20                  lt        6      2      4
21                 jtr       24      6      0
22                bool        1      0      0
23                 jmp       25      0      0
24                bool        1      1      0
25                 nop        0      0      0
26                 jtr       29      1      0
27                bool        0      0      0
28                 jmp       30      0      0
29                bool        0      1      0
30                 nop        0      0      0
31                jntr       34      0      0
32         cursor_read        0      0      0
33                send        0      0      0
34         cursor_next        0      6      0
35        cursor_close        0      0      0
36               ready        0     -1      0
37                 ret        0      0      0

"
select * from test where a > 1 and b < 1 and a < 10
# test: key compound gt and eq
explain select * from test where a > 1 and b = 10
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2                 int        0     10      0
 3                push        0      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       22      0      0
 6          cursor_idx        1      0      0
 7                 int        2      1      0
 8                  gt        3      1      2
 9                jntr       14      3      0
10          cursor_idx        1      0      1
11                 int        2     10      0
12                 equ        4      1      2
13                 jtr       16      4      0
14                bool        0      0      0
15                 jmp       17      0      0
16                bool        0      1      0
17                 nop        0      0      0
18                jntr       21      0      0
19         cursor_read        0      0      0
20                send        0      0      0
21         cursor_next        0      6      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0

"
select * from test where a > 1 and b = 10
# test: key compound gt and eq and eq (inner)
explain select * from test where a > 1 and b = 10 and b = 20
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2                 int        0     10      0
 3                push        0      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       31      0      0
 6          cursor_idx        1      0      0
 7                 int        2      1      0
 8                  gt        3      1      2
 9                jntr       23      3      0
10          cursor_idx        2      0      1
11                 int        4     10      0
12                 equ        5      2      4
13                jntr       18      5      0
14          cursor_idx        2      0      1
15                 int        4     20      0
16                 equ        6      2      4
17                 jtr       20      6      0
18                bool        1      0      0
19                 jmp       21      0      0
20                bool        1      1      0
21                 nop        0      0      0
22                 jtr       25      1      0
23                bool        0      0      0
24                 jmp       26      0      0
25                bool        0      1      0
26                 nop        0      0      0
27                jntr       30      0      0
28         cursor_read        0      0      0
29                send        0      0      0
30         cursor_next        0      6      0
31        cursor_close        0      0      0
32               ready        0     -1      0
33                 ret        0      0      0

"
select * from test where a > 1 and b = 10 and b = 20
# test: key compound gt and eq and eq (outer)
explain select * from test where a > 1 and b = 10 and a = 20
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0     20      0
 1                push        0      0      0
 2                 int        0     10      0
 3                push        0      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       31      0      0
 6          cursor_idx        1      0      0
 7                 int        2      1      0
 8                  gt        3      1      2
 9                jntr       23      3      0
10          cursor_idx        2      0      1
11                 int        4     10      0
12                 equ        5      2      4
13                jntr       18      5      0
14          cursor_idx        2      0      0
15                 int        4     20      0
16                 equ        6      2      4
17                 jtr       20      6      0
18                bool        1      0      0
19                 jmp       21      0      0
20                bool        1      1      0
21                 nop        0      0      0
22                 jtr       25      1      0
23                bool        0      0      0
24                 jmp       26      0      0
25                bool        0      1      0
26                 nop        0      0      0
27                jntr        5      0      0
28         cursor_read        0      0      0
29                send        0      0      0
30         cursor_next        0      6      0
31        cursor_close        0      0      0
32               ready        0     -1      0
33                 ret        0      0      0

"
select * from test where a > 1 and b = 10 and a = 20
# test: key compound eq and eq
explain select * from test where a = 1 and b = 10
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2                 int        0     10      0
 3                push        0      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       22      0      0
 6          cursor_idx        1      0      0
 7                 int        2      1      0
 8                 equ        3      1      2
 9                jntr       14      3      0
10          cursor_idx        1      0      1
11                 int        2     10      0
12                 equ        4      1      2
13                 jtr       16      4      0
14                bool        0      0      0
15                 jmp       17      0      0
16                bool        0      1      0
17                 nop        0      0      0
18                jntr        5      0      0
19         cursor_read        0      0      0
20                send        0      0      0
21         cursor_next        0      6      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0

"
select * from test where a = 1 and b = 10
# test: key compound eq and gt
explain select * from test where a = 1 and b > 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0                 int        0      1      0
 1                push        0      0      0
 2                 int        0      1      0
 3                push        0      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       22      0      0
 6          cursor_idx        1      0      0
 7                 int        2      1      0
 8                 equ        3      1      2
 9                jntr       14      3      0
10          cursor_idx        1      0      1
11                 int        2      1      0
12                  gt        4      1      2
13                 jtr       16      4      0
14                bool        0      0      0
15                 jmp       17      0      0
16                bool        0      1      0
17                 nop        0      0      0
18                jntr       21      0      0
19         cursor_read        0      0      0
20                send        0      0      0
21         cursor_next        0      6      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0

"
select * from test where a = 1 and b > 1
drop table test
disconnect S0
env_close E0
