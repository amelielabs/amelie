#

open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }];
connect E0 S0 127.0.0.1:3485;

# test: alter partition statement parsing
alter partition;
alter partition xyz;
alter partition 1;
alter partition 1 on;
alter partition 1 on xyz;
alter partition 1 on xyz qwerty;

## test: alter partition refresh
create storage a;
create storage b;
create storage c;

create table test (id int primary key, a int, b int) partitions 5
    on storage
       a (id "00000000-0000-0000-0000-000000000000"),
       b (id "00000000-0000-0000-0000-000000000001"),
       c (id "00000000-0000-0000-0000-000000000002");

show partitions on test;

alter partition 1 on test refresh;
show partitions on test;
show partition '6' on test;

# test: alter partition move
alter partition 6 on test move to b;

# 7 used by the service file
show partition '8' on test;

# test: alter partition move (same partition)
alter partition 8 on test move to b;
show partition '10' on test;

# test: alter partition move (storage not exists)
alter partition 10 on test move to xyz;
show partition '10' on test;
show partition '12' on test;

drop table test;
drop storage a;
drop storage b;
drop storage c;

disconnect S0;
close E0;
