#

open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }]
connect E0 S0 localhost:3485

# test: length/size
select ""::length
select ""::size
select "hello"::length
select "hello"::size

select null::size
select []::size
select [1,2,3]::size

select {}::size
select {"a": null}::size
select {"a": null, "b": null}::size

select (select * from [1,2,3])::size

# test: concat
select concat()
select concat(null)
select concat(null, null)
select concat("a", null)
select concat("a", null, "b")
select concat("a", null, "b")
select concat("a", null, "b", 3)
select concat("a", null, "b", 3::string)

select lambda list("") = list::concat(*::string) from [1,2,3]
select (lambda list("") = list::concat(*::string))::size from [1,2,3]

# test: lower
select ""::lower
select "Hello World"::lower
select null::lower

# test: upper
select ""::upper
select "Hello World"::upper

# test: substr

# start from one
select substr("")
select substr("hi", 0)

select substr("hi", 1)
select substr("hi", 2)
select substr("hi", 3)

select substr("hi", 1, 0)
select substr("hi", 1, 1)
select substr("hi", 1, 2)
select substr("hi", 1, 3)

select "hello"::substr(2)
select "hello"::substr(2, 1)
select "hello"::substr(2, 2)
select "hello"::substr(2, 3)
select "hello"::substr(2, 4)
select "hello"::substr(2, 5)

# test: strpos
select "hello"::strpos("")
select "hello"::strpos("h")
select "hello"::strpos("e")
select "hello"::strpos("l")
select "hello"::strpos("ll")
select "hello"::strpos("llo")
select "hello"::strpos("lloo")
select "hello"::strpos("lo")
select "hello"::strpos("o")

select substr("hello", "hello"::strpos("lo"), 2)

# test: replace
select replace('The cat sat on the mat, mat, mat in the corner of the room.','mat','rug')

select "hihi"::replace("hi", "hello ")
select "hihellohi"::replace("hi", "")
select "hihellohi"::replace("hello", "")
select "hihi"::replace("hi", "")

select "hihello"::replace("hello", "X")
select "hihell"::replace("hello", "X")
select "hihel"::replace("hello", "X")
select "hihe"::replace("hello", "X")
select "hih"::replace("hello", "X")
select "hi"::replace("hello", "X")

select "hellohi"::replace("hello", "X")
select "hellhi"::replace("hello", "X")
select "helhi"::replace("hello", "X")
select "hehi"::replace("hello", "X")
select "hhi"::replace("hello", "X")

select "hhi"::replace("", "X")

# test: ltrim
select ""::ltrim()
select ""::ltrim("")
select ""::ltrim(null)
select "  	 123"::ltrim()
select "  123"::ltrim(" ")
select "  123  "::ltrim(" 1")
select "$$123"::ltrim("$")
select "$$"::ltrim("$")

# test: rtrim
select ""::rtrim()
select ""::rtrim("")
select ""::rtrim(null)
select "  	 123"::rtrim()
select "  123  "::rtrim(" ")
select "  123  "::rtrim(" 13")
select "$$123 $$"::rtrim("$")
select "$$"::rtrim("$")
select "123$"::rtrim("$")
select "$"::rtrim("$")
select ""::rtrim("$")

# test: trim
select ""::trim()
select ""::trim("")
select ""::trim(null)
select "  	 123"::trim()
select "  123  "::trim(" ")
select "  123  "::trim(" 13")
select "$$123 $$"::trim("$")
select "$$"::trim("$")
select "123$"::trim("$")
select "$"::trim("$")
select ""::trim("$")

# test: like
select 'hello, world'::like('hello%world')
select 'hello, world' like 'hello%world'
select public.like('hello, world', 'hello%world')
select like('hello, world', 'hello%world')

disconnect S0
close E0
