#

env_open E0 "cluster_shards": 3
connect E0 S0

# test: reference table create
create table test (id int primary key, data int default 0) reference
select *.name, *.reference from system.tables()

# test: reference has single storage
select sizeof(storages) = 1 from system.tables()

# test: reference has no shard id
select storages[0].shard from system.tables()

drop table test

# test: table create
create table test (id int primary key, data int default 0)
select *.name, *.reference from system.tables()

# test: table partitions created on each shard
select sizeof(storages) = 3 from system.tables()

drop table test

disconnect S0
env_close E0
