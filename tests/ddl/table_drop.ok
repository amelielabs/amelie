open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }];
connect E0 S0 127.0.0.1:3485;
# test: drop table statement parsing
drop;
{"msg": "drop❰;❱ ⟵ USER|REPLICA|STORAGE|DATABASE|TABLE|INDEX|FUNCTION expected"}
drop 1;
{"msg": "drop ❰1❱ ⟵ USER|REPLICA|STORAGE|DATABASE|TABLE|INDEX|FUNCTION expected"}
drop table "name";
{"msg": "drop table ❰\"name\"❱ ⟵ name expected"}
drop table name junk;
{"msg": "drop table name ❰junk❱ ⟵ ; expected"}
# test: drop non-existing table
drop table name;
{"msg": "table 'name': not exists"}
drop table if exists test;
# test: drop table
create table test(id int primary key);
select show('table', 'test', true).name;
["test"]
drop table test;
select show('table', 'test', true).name;
[null]
# test: drop table if exists
create table test(id int primary key);
select show('table', 'test', true).name;
["test"]
drop table test;
select show('table', 'test', true).name;
[null]
drop table if exists test;
# test: recreate same table after drop
create table test (id int primary key);
select show('table', 'test', true).name;
["test"]
drop table test;
create table test (id int primary key);
select show('table', 'test', true).name;
["test"]
drop table test;
# test: drop table with udf dep
create table test (id int primary key);
create function dep() begin insert into test values (123); end;
show functions extended;
[{
  "db": "main",
  "name": "dep",
  "text": "begin insert into test values (123); end",
  "type": 0,
  "args": [],
  "returning": []
}]
drop table test;
{"msg": "function 'dep' depends on relation 'test"}
# test: drop table after udf drop
drop function dep;
drop table test;
disconnect S0;
close E0;
