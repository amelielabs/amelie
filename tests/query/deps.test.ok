open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }]
connect E0 S0 127.0.0.1:3485
# test: select var
explain declare x int; select x
[{
  "bytecode": {
    "frontend": {
      "00": "dup                 1      0      0     ",
      "01": "content             1      -      -     ",
      "02": "ret                 0      0      0     "
    }
  },
  "access": []
}]
declare x int; select x
[null]
# test: select var expr
explain declare x int := 0; select x
[{
  "bytecode": {
    "frontend": {
      "00": "int                 1      -      0     # 0",
      "01": "assign              0      1      0     ",
      "02": "free                1      0      0     ",
      "03": "dup                 1      0      0     ",
      "04": "content             1      -      -     ",
      "05": "ret                 0      0      0     "
    }
  },
  "access": []
}]
declare x int := 0; select x
[0]
explain declare x int := 0; select x; x:= 15; select x
[{
  "bytecode": {
    "frontend": {
      "00": "int                 1      -      0     # 0",
      "01": "assign              0      1      0     ",
      "02": "free                1      0      0     ",
      "03": "dup                 1      0      0     ",
      "04": "int                 2      -      0     # 15",
      "05": "assign              0      2      0     ",
      "06": "free                2      0      0     ",
      "07": "dup                 2      0      0     ",
      "08": "content             2      -      -     ",
      "09": "ret                 0      0      0     "
    }
  },
  "access": []
}]
declare x int := 0; select x; x:= 15; select x
[15]
# test: select into expr
explain declare x int; select 123 into x; select x
[{
  "bytecode": {
    "frontend": {
      "00": "int                 1      -      0     # 123",
      "01": "assign              0      1      0     ",
      "02": "free                1      0      0     ",
      "03": "dup                 1      0      0     ",
      "04": "content             1      -      -     ",
      "05": "ret                 0      0      0     "
    }
  },
  "access": []
}]
declare x int; select 123 into x; select x
[123]
explain declare x int; select 123 into x; select x; select 15 into x; select x
[{
  "bytecode": {
    "frontend": {
      "00": "int                 1      -      0     # 123",
      "01": "assign              0      1      0     ",
      "02": "free                1      0      0     ",
      "03": "dup                 1      0      0     ",
      "04": "int                 2      -      0     # 15",
      "05": "assign              0      2      0     ",
      "06": "free                2      0      0     ",
      "07": "dup                 2      0      0     ",
      "08": "content             2      -      -     ",
      "09": "ret                 0      0      0     "
    }
  },
  "access": []
}]
declare x int; select 123 into x; select x; select 15 into x; select x
[15]
# test: select from into (no recv)
create table test (id int primary key)
insert into test values (1), (2), (3)
explain declare x int; select id into x from test
[{
  "bytecode": {
    "frontend": {
      "00": "union               1      0      0     ",
      "01": "send_all            0      -      1     # public.test (last)",
      "02": "union_recv          1      0      0     ",
      "03": "union_set           1      0      -1    ",
      "04": "assign              0      1      0     ",
      "05": "free                1      0      0     ",
      "06": "ret                 0      0      0     "
    },
    "backend": {
      "00": "set                 1      1      0     ",
      "01": "table_open_part     2      0      6     # public.test (primary)",
      "02": "table_readi32       3      2      0     ",
      "03": "push                3      0      0     ",
      "04": "set_add             1      0      0     ",
      "05": "table_next          2      2      0     ",
      "06": "free                2      0      0     ",
      "07": "result              1      0      0     ",
      "08": "ret                 0      0      0     "
    }
  },
  "access": [["public.test", "ro"]]
}]
declare x int; select id into x from test
# test: select from into / select var
explain declare x int; select id into x from test; select x
[{
  "bytecode": {
    "frontend": {
      "00": "union               1      0      0     ",
      "01": "send_all            0      -      1     # public.test (last)",
      "02": "union_recv          1      0      0     ",
      "03": "union_set           1      0      -1    ",
      "04": "assign              0      1      0     ",
      "05": "free                1      0      0     ",
      "06": "dup                 1      0      0     ",
      "07": "content             1      -      -     ",
      "08": "ret                 0      0      0     "
    },
    "backend": {
      "00": "set                 1      1      0     ",
      "01": "table_open_part     2      0      6     # public.test (primary)",
      "02": "table_readi32       3      2      0     ",
      "03": "push                3      0      0     ",
      "04": "set_add             1      0      0     ",
      "05": "table_next          2      2      0     ",
      "06": "free                2      0      0     ",
      "07": "result              1      0      0     ",
      "08": "ret                 0      0      0     "
    }
  },
  "access": [["public.test", "ro"]]
}]
declare x int; select id into x from test; select x
[1]
# test: select from into / select expr / select var
explain declare x int; select id into x from test; select 123; select x
[{
  "bytecode": {
    "frontend": {
      "00": "union               1      0      0     ",
      "01": "send_all            0      -      1     # public.test (last)",
      "02": "int                 2      -      0     # 123",
      "03": "union_recv          1      0      0     ",
      "04": "union_set           1      0      -1    ",
      "05": "assign              0      1      0     ",
      "06": "free                1      0      0     ",
      "07": "dup                 1      0      0     ",
      "08": "content             1      -      -     ",
      "09": "ret                 0      0      0     "
    },
    "backend": {
      "00": "set                 1      1      0     ",
      "01": "table_open_part     2      0      6     # public.test (primary)",
      "02": "table_readi32       3      2      0     ",
      "03": "push                3      0      0     ",
      "04": "set_add             1      0      0     ",
      "05": "table_next          2      2      0     ",
      "06": "free                2      0      0     ",
      "07": "result              1      0      0     ",
      "08": "ret                 0      0      0     "
    }
  },
  "access": [["public.test", "ro"]]
}]
declare x int; select id into x from test; select 123; select x
[1]
# test: select from into / select from / select var
explain declare x int; select id into x from test; select * from test; select x
[{
  "bytecode": {
    "frontend": {
      "00": "union               1      0      0     ",
      "01": "send_all            0      -      1     # public.test",
      "02": "union               2      0      0     ",
      "03": "send_all            9      -      2     # public.test (last)",
      "04": "union_recv          1      0      0     ",
      "05": "union_set           1      0      -1    ",
      "06": "assign              0      1      0     ",
      "07": "free                1      0      0     ",
      "08": "dup                 1      0      0     ",
      "09": "union_recv          2      0      0     ",
      "10": "union_set           2      0      -1    ",
      "11": "content             1      -      -     ",
      "12": "ret                 0      0      0     "
    },
    "backend": {
      "00": "set                 1      1      0     ",
      "01": "table_open_part     2      0      6     # public.test (primary)",
      "02": "table_readi32       3      2      0     ",
      "03": "push                3      0      0     ",
      "04": "set_add             1      0      0     ",
      "05": "table_next          2      2      0     ",
      "06": "free                2      0      0     ",
      "07": "result              1      0      0     ",
      "08": "ret                 0      0      0     ",
      "09": "set                 2      1      0     ",
      "10": "table_open_part     3      20     15    # public.test (primary)",
      "11": "table_readi32       4      3      0     ",
      "12": "push                4      0      0     ",
      "13": "set_add             2      0      0     ",
      "14": "table_next          3      11     0     ",
      "15": "free                3      0      0     ",
      "16": "result              2      0      0     ",
      "17": "ret                 0      0      0     "
    }
  },
  "access": [["public.test", "ro"]]
}]
declare x int; select id into x from test; select * from test; select x
[1]
# test: select from into / select expr / select from var
explain declare x int; select id into x from test; select 123; select * from x
[{
  "bytecode": {
    "frontend": {
      "00": "union               1      0      0     ",
      "01": "send_all            0      -      1     # public.test (last)",
      "02": "int                 2      -      0     # 123",
      "03": "union_recv          1      0      0     ",
      "04": "union_set           1      0      -1    ",
      "05": "assign              0      1      0     ",
      "06": "free                1      0      0     ",
      "07": "set                 1      1      0     ",
      "08": "dup                 3      0      0     ",
      "09": "push                3      0      0     ",
      "10": "set                 3      1      0     ",
      "11": "set_add             3      0      0     ",
      "12": "store_open          4      3      17    ",
      "13": "store_read          5      4      0     ",
      "14": "push                5      0      0     ",
      "15": "set_add             1      0      0     ",
      "16": "store_next          4      13     0     ",
      "17": "free                4      0      0     ",
      "18": "free                3      0      0     ",
      "19": "content             1      -      -     ",
      "20": "ret                 0      0      0     "
    },
    "backend": {
      "00": "set                 1      1      0     ",
      "01": "table_open_part     2      0      6     # public.test (primary)",
      "02": "table_readi32       3      2      0     ",
      "03": "push                3      0      0     ",
      "04": "set_add             1      0      0     ",
      "05": "table_next          2      2      0     ",
      "06": "free                2      0      0     ",
      "07": "result              1      0      0     ",
      "08": "ret                 0      0      0     "
    }
  },
  "access": [["public.test", "ro"]]
}]
declare x int; select id into x from test; select 123; select * from x
[1]
# test: select from into / select from into
explain declare x int; select id into x from test; select 123 into x from test
[{
  "bytecode": {
    "frontend": {
      "00": "union               1      0      0     ",
      "01": "send_all            0      -      1     # public.test",
      "02": "union_recv          1      0      0     ",
      "03": "union_set           1      0      -1    ",
      "04": "assign              0      1      0     ",
      "05": "free                1      0      0     ",
      "06": "union               1      0      0     ",
      "07": "send_all            9      -      1     # public.test (last)",
      "08": "union_recv          1      0      0     ",
      "09": "union_set           1      0      -1    ",
      "10": "assign              0      1      0     ",
      "11": "free                1      0      0     ",
      "12": "ret                 0      0      0     "
    },
    "backend": {
      "00": "set                 1      1      0     ",
      "01": "table_open_part     2      0      6     # public.test (primary)",
      "02": "table_readi32       3      2      0     ",
      "03": "push                3      0      0     ",
      "04": "set_add             1      0      0     ",
      "05": "table_next          2      2      0     ",
      "06": "free                2      0      0     ",
      "07": "result              1      0      0     ",
      "08": "ret                 0      0      0     ",
      "09": "set                 1      1      0     ",
      "10": "table_open_part     2      20     15    # public.test (primary)",
      "11": "int                 3      -      0     # 123",
      "12": "push                3      0      0     ",
      "13": "set_add             1      0      0     ",
      "14": "table_next          2      11     0     ",
      "15": "free                2      0      0     ",
      "16": "result              1      0      0     ",
      "17": "ret                 0      0      0     "
    }
  },
  "access": [["public.test", "ro"]]
}]
declare x int; select id into x from test; select 123 into x from test
# test: select from into / select from into / select var
explain declare x int; select id into x from test; select 123 into x from test; select x
[{
  "bytecode": {
    "frontend": {
      "00": "union               1      0      0     ",
      "01": "send_all            0      -      1     # public.test",
      "02": "union_recv          1      0      0     ",
      "03": "union_set           1      0      -1    ",
      "04": "assign              0      1      0     ",
      "05": "free                1      0      0     ",
      "06": "union               1      0      0     ",
      "07": "send_all            9      -      1     # public.test (last)",
      "08": "union_recv          1      0      0     ",
      "09": "union_set           1      0      -1    ",
      "10": "assign              0      1      0     ",
      "11": "free                1      0      0     ",
      "12": "dup                 1      0      0     ",
      "13": "content             1      -      -     ",
      "14": "ret                 0      0      0     "
    },
    "backend": {
      "00": "set                 1      1      0     ",
      "01": "table_open_part     2      0      6     # public.test (primary)",
      "02": "table_readi32       3      2      0     ",
      "03": "push                3      0      0     ",
      "04": "set_add             1      0      0     ",
      "05": "table_next          2      2      0     ",
      "06": "free                2      0      0     ",
      "07": "result              1      0      0     ",
      "08": "ret                 0      0      0     ",
      "09": "set                 1      1      0     ",
      "10": "table_open_part     2      20     15    # public.test (primary)",
      "11": "int                 3      -      0     # 123",
      "12": "push                3      0      0     ",
      "13": "set_add             1      0      0     ",
      "14": "table_next          2      11     0     ",
      "15": "free                2      0      0     ",
      "16": "result              1      0      0     ",
      "17": "ret                 0      0      0     "
    }
  },
  "access": [["public.test", "ro"]]
}]
declare x int; select id into x from test; select 123 into x from test; select x
[123]
# test: select expr into / select from into
explain declare x int; select 123 into x; select id into x from test
[{
  "bytecode": {
    "frontend": {
      "00": "int                 1      -      0     # 123",
      "01": "assign              0      1      0     ",
      "02": "free                1      0      0     ",
      "03": "union               1      0      0     ",
      "04": "send_all            0      -      1     # public.test (last)",
      "05": "union_recv          1      0      0     ",
      "06": "union_set           1      0      -1    ",
      "07": "assign              0      1      0     ",
      "08": "free                1      0      0     ",
      "09": "ret                 0      0      0     "
    },
    "backend": {
      "00": "set                 1      1      0     ",
      "01": "table_open_part     2      0      6     # public.test (primary)",
      "02": "table_readi32       3      2      0     ",
      "03": "push                3      0      0     ",
      "04": "set_add             1      0      0     ",
      "05": "table_next          2      2      0     ",
      "06": "free                2      0      0     ",
      "07": "result              1      0      0     ",
      "08": "ret                 0      0      0     "
    }
  },
  "access": [["public.test", "ro"]]
}]
declare x int; select 123 into x; select id into x from test
# test: select expr into / select from into / select var
explain declare x int; select 123 into x; select id into x from test; select x
[{
  "bytecode": {
    "frontend": {
      "00": "int                 1      -      0     # 123",
      "01": "assign              0      1      0     ",
      "02": "free                1      0      0     ",
      "03": "union               1      0      0     ",
      "04": "send_all            0      -      1     # public.test (last)",
      "05": "union_recv          1      0      0     ",
      "06": "union_set           1      0      -1    ",
      "07": "assign              0      1      0     ",
      "08": "free                1      0      0     ",
      "09": "dup                 1      0      0     ",
      "10": "content             1      -      -     ",
      "11": "ret                 0      0      0     "
    },
    "backend": {
      "00": "set                 1      1      0     ",
      "01": "table_open_part     2      0      6     # public.test (primary)",
      "02": "table_readi32       3      2      0     ",
      "03": "push                3      0      0     ",
      "04": "set_add             1      0      0     ",
      "05": "table_next          2      2      0     ",
      "06": "free                2      0      0     ",
      "07": "result              1      0      0     ",
      "08": "ret                 0      0      0     "
    }
  },
  "access": [["public.test", "ro"]]
}]
declare x int; select 123 into x; select id into x from test; select x
[1]
drop table test
disconnect S0
close E0
