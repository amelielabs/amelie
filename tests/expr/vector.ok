open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }];
connect E0 S0 127.0.0.1:3485;
# test: vector create
select [1,2,3]::vector;
[[1, 2, 3]]
select [1,2,3]::vector::type;
["vector"]
select [1,2,3]::vector::length;
[3]
select ""::vector;
{"msg": "vector(❰string❱ ⟵ unsupported argument type"}
select [1.0]::vector;
[[1]]
select [1.0, 1.1, 1.2]::vector;
[[1, 1.1, 1.2]]
select []::vector;
[[]]
select []::vector::length;
[0]
select vector [1,2,3];
[[1, 2, 3]]
select vector [1,2,3]::type;
["vector"]
select vector [1,2,3]::length;
[3]
select vector "";
{"msg": "select vector ❰\"\"❱ ⟵ [ expected"}
select vector [1.0];
[[1]]
select vector [1.0, 1.1, 1.2];
[[1, 1.1, 1.2]]
select vector [];
[[]]
select vector []::length;
[0]
# test: vector = vector
select [1.0, 1.1]::vector = [1.0, 1.1]::vector;
[true]
select [1.0, 1.1]::vector = [1.0, 1.0]::vector;
[false]
select [1.0, 1.1]::vector = [1.0]::vector;
[false]
select [1.0, 1.1]::vector = []::vector;
[false]
explain select []::vector = []::vector;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "push_json           2      0      0     ",
    "03": "call                1      -      1     # public.vector()",
    "04": "equvv               2      0      1     ",
    "05": "ret                 2      0      -     "
  },
  "access": []
}]
select vector [1.0, 1.1] = vector [1.0, 1.1];
[true]
select vector [1.0, 1.1] = vector [1.0, 1.0];
[false]
select vector [1.0, 1.1] = vector [1.0];
[false]
select vector [1.0, 1.1] = vector [];
[false]
explain select vector [] = vector [];
[{
  "main": {
    "00": "vector              0      0      0     ",
    "01": "vector              1      4      0     ",
    "02": "equvv               2      0      1     ",
    "03": "ret                 2      0      -     "
  },
  "access": []
}]
# test: vector = null
select [1.0, 1.1]::vector = null;
[null]
explain select [1.0, 1.1]::vector = null;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "null                1      0      0     ",
    "03": "nullop              2      0      1     ",
    "04": "ret                 2      0      -     "
  },
  "access": []
}]
# test: vector = unsupported
select [1.0, 1.1]::vector = 1;
{"msg": "select [1.0, 1.1]::vector = ❰1❱ ⟵ operation vector = int is not supported"}
# test: vector <> vector
select [1.0, 1.1]::vector <> [1.0, 1.1]::vector;
[false]
select [1.0, 1.1]::vector <> [1.0, 1.0]::vector;
[true]
select [1.0, 1.1]::vector <> [1.0]::vector;
[true]
select [1.0, 1.1]::vector <> []::vector;
[true]
explain select []::vector <> []::vector;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "push_json           2      0      0     ",
    "03": "call                1      -      1     # public.vector()",
    "04": "equvv               2      0      1     ",
    "05": "not                 0      2      0     ",
    "06": "ret                 0      0      -     "
  },
  "access": []
}]
# test: vector <> null
select [1.0, 1.1]::vector <> null;
[null]
explain select [1.0, 1.1]::vector <> null;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "null                1      0      0     ",
    "03": "nullop              2      0      1     ",
    "04": "not                 0      2      0     ",
    "05": "ret                 0      0      -     "
  },
  "access": []
}]
# test: vector <> unsupported
select [1.0, 1.1]::vector <> 1;
{"msg": "select [1.0, 1.1]::vector <> ❰1❱ ⟵ operation vector = int is not supported"}
# test: vector >= vector
select [1.0, 1.1]::vector >= [1.0, 1.1]::vector;
[true]
select [1.0, 1.2]::vector >= [1.0, 1.1]::vector;
[true]
select [1.0, 1.1]::vector >= [1.0]::vector;
[true]
explain select [1.0, 1.1]::vector >= [1.0]::vector;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "push_json           12     0      0     ",
    "03": "call                1      -      1     # public.vector()",
    "04": "gtevv               2      0      1     ",
    "05": "ret                 2      0      -     "
  },
  "access": []
}]
# test: vector >= null
select [1.0, 1.1]::vector >= null;
[null]
# test: vector >= unsupported
select [1.0, 1.1]::vector >= [];
{"msg": "select [1.0, 1.1]::vector >= ❰[❱ ⟵ operation vector >= json is not supported"}
# test: vector > vector
select [1.0, 1.1]::vector > [1.0, 1.1]::vector;
[false]
select [1.0, 1.2]::vector > [1.0, 1.1]::vector;
[true]
select [1.0, 1.1]::vector > [1.0]::vector;
[true]
explain select [1.0, 1.1]::vector > [1.0]::vector;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "push_json           12     0      0     ",
    "03": "call                1      -      1     # public.vector()",
    "04": "gtvv                2      0      1     ",
    "05": "ret                 2      0      -     "
  },
  "access": []
}]
# test: vector > null
select [1.0, 1.1]::vector > null;
[null]
# test: vector > unsupported
select [1.0, 1.1]::vector > [];
{"msg": "select [1.0, 1.1]::vector > ❰[❱ ⟵ operation vector > json is not supported"}
# test: vector <= vector
select [1.0, 1.1]::vector <= [1.0, 1.1]::vector;
[true]
select [1.0, 1.1]::vector <= [1.0, 1.2]::vector;
[true]
select [1.0, 1.3]::vector <= [1.0, 1.2]::vector;
[false]
explain select [1.0, 1.3]::vector <= [1.0, 1.2]::vector;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "push_json           12     0      0     ",
    "03": "call                1      -      1     # public.vector()",
    "04": "ltevv               2      0      1     ",
    "05": "ret                 2      0      -     "
  },
  "access": []
}]
# test: vector <= null
select [1.0, 1.1]::vector <= null;
[null]
# test: vector <= unsupported
select [1.0, 1.1]::vector <= [];
{"msg": "select [1.0, 1.1]::vector <= ❰[❱ ⟵ operation vector <= json is not supported"}
# test: vector < vector
select [1.0, 1.1]::vector < [1.0, 1.1]::vector;
[false]
select [1.0, 1.1]::vector < [1.0, 1.2]::vector;
[true]
select [1.0, 1.3]::vector < [1.0, 1.2]::vector;
[false]
select [1.0, 1.1]::vector < [1.0]::vector;
[false]
# test: vector < null
select [1.0, 1.1]::vector < null;
[null]
# test: vector < unsupported
select [1.0, 1.1]::vector < [];
{"msg": "select [1.0, 1.1]::vector < ❰[❱ ⟵ operation vector < json is not supported"}
# test: vector + vector
select [1.0, 2.1, 3]::vector + [1, 1, 1]::vector;
[[2, 3.1, 4]]
select [1.0, 2.1, 3]::vector + [1, 1]::vector;
{"msg": "vector sizes mismatch"}
explain select [1.0, 2.1, 3]::vector + [1, 1]::vector;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "push_json           13     0      0     ",
    "03": "call                1      -      1     # public.vector()",
    "04": "addvv               2      0      1     ",
    "05": "ret                 2      0      -     "
  },
  "access": []
}]
# test: vector + null
select [1.0, 2.1, 3]::vector + null;
[null]
# test: vector + unsupported
select [1.0, 2.1, 3]::vector + [];
{"msg": "select [1.0, 2.1, 3]::vector + ❰[❱ ⟵ operation vector + json is not supported"}
# test: vector - vector
select [1.0, 2.1, 3]::vector - [1, 1, 1]::vector;
[[0, 1.1, 2]]
select [1.0, 2.1, 3]::vector - [1, 1]::vector;
{"msg": "vector sizes mismatch"}
explain select [1.0, 2.1, 3]::vector - [1, 1]::vector;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "push_json           13     0      0     ",
    "03": "call                1      -      1     # public.vector()",
    "04": "subvv               2      0      1     ",
    "05": "ret                 2      0      -     "
  },
  "access": []
}]
# test: vector - null
select [1.0, 2.1, 3]::vector - null;
[null]
explain select [1.0, 2.1, 3]::vector - null;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "null                1      0      0     ",
    "03": "nullop              2      0      1     ",
    "04": "ret                 2      0      -     "
  },
  "access": []
}]
# test: vector - unsupported
select [1.0, 2.1, 3]::vector - [];
{"msg": "select [1.0, 2.1, 3]::vector - ❰[❱ ⟵ operation vector - json is not supported"}
# test: vector * vector
select [1.0, 2.1, 3]::vector * [1.5, 1.5, 1.5]::vector;
[[1.5, 3.15, 4.5]]
select [1.0, 2.1, 3]::vector * [1.5, 1.5]::vector;
{"msg": "vector sizes mismatch"}
explain select [1.0, 2.1, 3]::vector * [1.5, 1.5]::vector;
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "push_json           13     0      0     ",
    "03": "call                1      -      1     # public.vector()",
    "04": "mulvv               2      0      1     ",
    "05": "ret                 2      0      -     "
  },
  "access": []
}]
# test: vector * null
select [1.0, 2.1, 3]::vector * null;
[null]
# test: vector * unsupported
select [1.0, 2.1, 3]::vector * null;
[null]
# test: vector [] int
select [1.0, 1.1, 1.2]::vector[0];
[1]
select [1.0, 1.1, 1.2]::vector[1];
[1.1]
select [1.0, 1.1, 1.2]::vector[2];
[1.2]
select [1.0, 1.1, 1.2]::vector[3];
{"msg": "[]: vector index is out of bounds"}
select [1.0, 1.1, 1.2]::vector[-10];
{"msg": "[]: vector index is out of bounds"}
explain select [1.0, 1.1, 1.2]::vector[-10];
[{
  "main": {
    "00": "push_json           0      0      0     ",
    "01": "call                0      -      1     # public.vector()",
    "02": "int                 1      -      0     # -10",
    "03": "idxvi               2      0      1     ",
    "04": "ret                 2      0      -     "
  },
  "access": []
}]
# test: vector [] null
select [1.0, 1.1, 1.2]::vector[null];
[null]
# test: vector [] unsupported
select [1.0, 1.1, 1.2]::vector[[]];
{"msg": "select [1.0, 1.1, 1.2]::vector[❰[❱ ⟵ operation vector [] json is not supported"}
disconnect S0;
close E0;
