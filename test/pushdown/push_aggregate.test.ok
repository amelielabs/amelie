env_open E0 "cluster_shards": 3
connect E0 S0
connect: on_connect
# test: select count from table empty
create table test (id int primary key, data int)
explain select count(*) from test
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2    cursor_open_expr        1      0      4
 3                 jmp        7      0      0
 4      group_get_aggr        1      1      0
 5                send        1      0      0
 6         cursor_next        1      4      0
 7        cursor_close        1      0      0
 8                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0

"
select count(*) from test
0
# test: select count from table
insert into test values (0, 0)
insert into test values (1, 0)
insert into test values (2, 1)
insert into test values (3, 1)
insert into test values (4, 2)
select * from test
[0, 0]
[2, 1]
[1, 0]
[3, 1]
[4, 2]
explain select count(*) from test
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2    cursor_open_expr        1      0      4
 3                 jmp        7      0      0
 4      group_get_aggr        1      1      0
 5                send        1      0      0
 6         cursor_next        1      4      0
 7        cursor_close        1      0      0
 8                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0

"
select count(*) from test
5
# test: select sum from table empty
delete from test
explain select sum(id) from test
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2    cursor_open_expr        1      0      4
 3                 jmp        7      0      0
 4      group_get_aggr        1      1      0
 5                send        1      0      0
 6         cursor_next        1      4      0
 7        cursor_close        1      0      0
 8                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      0      0
 1      group_add_aggr        0      1      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      0      0
 1      group_add_aggr        0      1      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      0      0
 1      group_add_aggr        0      1      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0

"
select sum(id) from test
0
insert into test values (0, 0)
insert into test values (1, 0)
insert into test values (2, 1)
insert into test values (3, 1)
insert into test values (4, 2)
# test: select sum from table
explain select sum(id) from test
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2    cursor_open_expr        1      0      4
 3                 jmp        7      0      0
 4      group_get_aggr        1      1      0
 5                send        1      0      0
 6         cursor_next        1      4      0
 7        cursor_close        1      0      0
 8                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      0      0
 1      group_add_aggr        0      1      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      0      0
 1      group_add_aggr        0      1      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      0      0
 1      group_add_aggr        0      1      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0

"
select sum(id) from test
10
select sum(data) from test
4
# test: select avg from table empty
delete from test
select avg(id) from test
0
insert into test values (0, 0)
insert into test values (1, 0)
insert into test values (2, 1)
insert into test values (3, 1)
insert into test values (4, 2)
# test: select avg from table
explain select avg(id) from test
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2    cursor_open_expr        1      0      4
 3                 jmp        7      0      0
 4      group_get_aggr        1      1      0
 5                send        1      0      0
 6         cursor_next        1      4      0
 7        cursor_close        1      0      0
 8                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      0      0
 1      group_add_aggr        0      2      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      0      0
 1      group_add_aggr        0      2      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      0      0
 1      group_add_aggr        0      2      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0

"
select avg(id) from test
2
select avg(data) from test
0
# test: select min from table empty
delete from test
select min(id) from test
0
insert into test values (0, 0)
insert into test values (1, 0)
insert into test values (2, 1)
insert into test values (3, 1)
insert into test values (4, 2)
# test: select min from table
select min(id) from test
0
select min(data) from test
0
# test: select max from table empty
delete from test
select max(id) from test
0
insert into test values (0, 0)
insert into test values (1, 0)
insert into test values (2, 1)
insert into test values (3, 1)
insert into test values (4, 2)
# test: select max from table
select max(id) from test
4
select max(data) from test
2
# test: select from (select aggr from table)
explain select * from (select count(*) from test)
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2                 set        1      0      0
 3    cursor_open_expr        1      0      5
 4                 jmp        8      0      0
 5      group_get_aggr        2      1      0
 6             set_add        1      2      0
 7         cursor_next        1      5      0
 8        cursor_close        1      0      0
 9    cursor_open_expr        2      1     11
10                 jmp       14      0      0
11         cursor_read        0      2      0
12                send        0      0      0
13         cursor_next        2     11      0
14        cursor_close        2      0      0
15                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14               ready        0      0      0
15                 ret        0      0      0

"
select * from (select count(*) from test)
5
# test: select aggr from table group by
explain select id, count(*) from test group by id
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2    cursor_open_expr        1      0      4
 3                 jmp       11      0      0
 4           group_get        1      1      0
 5                push        1      0      0
 6      group_get_aggr        1      1      0
 7                push        1      0      0
 8               array        1      2      0
 9                send        1      0      0
10         cursor_next        1      4      0
11        cursor_close        1      0      0
12                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0

"
select id, count(*) from test group by id
[0, 1]
[1, 1]
[2, 1]
[3, 1]
[4, 1]
select data, count(*) from test group by data
[0, 2]
[1, 2]
[2, 1]
# test: select from (select aggr from table group by)
explain select * from (select id, count(*) from test group by id)
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2                 set        1      0      0
 3    cursor_open_expr        1      0      5
 4                 jmp       12      0      0
 5           group_get        2      1      0
 6                push        2      0      0
 7      group_get_aggr        2      1      0
 8                push        2      0      0
 9               array        2      2      0
10             set_add        1      2      0
11         cursor_next        1      5      0
12        cursor_close        1      0      0
13    cursor_open_expr        2      1     15
14                 jmp       18      0      0
15         cursor_read        0      2      0
16                send        0      0      0
17         cursor_next        2     15      0
18        cursor_close        2      0      0
19                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0

"
select * from (select id, count(*) from test group by id)
[0, 1]
[1, 1]
[2, 1]
[3, 1]
[4, 1]
select * from (select data, count(*) from test group by data)
[0, 2]
[1, 2]
[2, 1]
# test: select from table having label
explain select id, count(*) c from test group by id having c >= 1
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2    cursor_open_expr        1      0      4
 3                 jmp       15      0      0
 4      group_get_aggr        1      1      0
 5                 int        2      1      0
 6                 gte        3      1      2
 7                jntr       14      3      0
 8           group_get        1      1      0
 9                push        1      0      0
10      group_get_aggr        1      1      0
11                push        1      0      0
12               array        1      2      0
13                send        1      0      0
14         cursor_next        1      4      0
15        cursor_close        1      0      0
16                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0

"
select id, count(*) c from test group by id having c >= 1
[0, 1]
[1, 1]
[2, 1]
[3, 1]
[4, 1]
select id, count(*) c from test group by id having c > 1
select data, count(*) c from test group by data having c > 1
[0, 2]
[1, 2]
select data, count(*) c from test group by data having data > 1
[2, 1]
# test: select from table having aggr
explain select data, count(*) from test group by data having count(*) = 2
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2    cursor_open_expr        1      0      4
 3                 jmp       15      0      0
 4      group_get_aggr        1      1      1
 5                 int        2      2      0
 6                 equ        3      1      2
 7                jntr       14      3      0
 8           group_get        1      1      0
 9                push        1      0      0
10      group_get_aggr        1      1      0
11                push        1      0      0
12               array        1      2      0
13                send        1      0      0
14         cursor_next        1      4      0
15        cursor_close        1      0      0
16                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2      group_add_aggr        0      0      1
 3             int_min        1      0      0
 4                push        1      0      0
 5         cursor_open        0      0      7      # public.test (primary)
 6                 jmp       15      0      0
 7          cursor_idx        1      0      1
 8                push        1      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11         cursor_read        1      0      0
12                push        1      0      0
13           group_add        0      0      0
14         cursor_next        0      7      0
15        cursor_close        0      0      0
16               ready        0      0      0
17                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2      group_add_aggr        0      0      1
 3             int_min        1      0      0
 4                push        1      0      0
 5         cursor_open        0      0      7      # public.test (primary)
 6                 jmp       15      0      0
 7          cursor_idx        1      0      1
 8                push        1      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11         cursor_read        1      0      0
12                push        1      0      0
13           group_add        0      0      0
14         cursor_next        0      7      0
15        cursor_close        0      0      0
16               ready        0      0      0
17                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2      group_add_aggr        0      0      1
 3             int_min        1      0      0
 4                push        1      0      0
 5         cursor_open        0      0      7      # public.test (primary)
 6                 jmp       15      0      0
 7          cursor_idx        1      0      1
 8                push        1      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11         cursor_read        1      0      0
12                push        1      0      0
13           group_add        0      0      0
14         cursor_next        0      7      0
15        cursor_close        0      0      0
16               ready        0      0      0
17                 ret        0      0      0

"
select data, count(*) from test group by data having count(*) = 2
[0, 2]
[1, 2]
explain select data from test group by data having count(*) = 2
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2    cursor_open_expr        1      0      4
 3                 jmp       11      0      0
 4      group_get_aggr        1      1      0
 5                 int        2      2      0
 6                 equ        3      1      2
 7                jntr       10      3      0
 8           group_get        1      1      0
 9                send        1      0      0
10         cursor_next        1      4      0
11        cursor_close        1      0      0
12                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      1
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      1
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      1
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0

"
select data from test group by data having count(*) = 2
0
1
# test: select from table group by order by aggr
explain select * from test group by data order by count(*)
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1    group_merge_recv        0      0      0
 2         set_ordered        1     20      0
 3    cursor_open_expr        1      0      5
 4                 jmp       10      0      0
 5         cursor_read        2      1      0
 6      group_get_aggr        3      1      0
 7                push        3      0      0
 8             set_add        1      2      0
 9         cursor_next        1      5      0
10        cursor_close        1      0      0
11            set_sort        1      0      0
12            send_set        1      0      0
13                 ret        0      0      0


bytecode [shard 0]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      1
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0


bytecode [shard 1]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      1
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0


bytecode [shard 2]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      1
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13               ready        0      0      0
14                 ret        0      0      0

"
select * from test group by data order by count(*) desc
0
1
2
select data, count(*) c from test group by data order by c desc
[0, 2]
[1, 2]
[2, 1]
drop table test
# test: select count from reference empty
create table test (id int primary key, data int) reference
explain select count(*) from test
"
bytecode [coordinator]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14    cursor_open_expr        1      0     16
15                 jmp       19      0      0
16      group_get_aggr        1      1      0
17                send        1      0      0
18         cursor_next        1     16      0
19        cursor_close        1      0      0
20                recv        0      0      0
21                 ret        0      0      0

"
select count(*) from test
0
# test: select count from reference
insert into test values (0, 0)
insert into test values (1, 0)
insert into test values (2, 1)
insert into test values (3, 1)
insert into test values (4, 2)
select * from test
[0, 0]
[1, 0]
[2, 1]
[3, 1]
[4, 2]
explain select count(*) from test
"
bytecode [coordinator]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9         cursor_read        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14    cursor_open_expr        1      0     16
15                 jmp       19      0      0
16      group_get_aggr        1      1      0
17                send        1      0      0
18         cursor_next        1     16      0
19        cursor_close        1      0      0
20                recv        0      0      0
21                 ret        0      0      0

"
select count(*) from test
5
# test: select sum from reference
explain select sum(id) from test
"
bytecode [coordinator]
--------
 0               group        0      0      0
 1      group_add_aggr        0      1      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14    cursor_open_expr        1      0     16
15                 jmp       19      0      0
16      group_get_aggr        1      1      0
17                send        1      0      0
18         cursor_next        1     16      0
19        cursor_close        1      0      0
20                recv        0      0      0
21                 ret        0      0      0

"
select sum(id) from test
10
select sum(data) from test
4
# test: select avg from reference
explain select avg(id) from test
"
bytecode [coordinator]
--------
 0               group        0      0      0
 1      group_add_aggr        0      2      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5             int_min        1      0      0
 6                push        1      0      0
 7         cursor_open        0      0      9      # public.test (primary)
 8                 jmp       13      0      0
 9          cursor_idx        1      0      0
10                push        1      0      0
11           group_add        0      0      0
12         cursor_next        0      9      0
13        cursor_close        0      0      0
14    cursor_open_expr        1      0     16
15                 jmp       19      0      0
16      group_get_aggr        1      1      0
17                send        1      0      0
18         cursor_next        1     16      0
19        cursor_close        1      0      0
20                recv        0      0      0
21                 ret        0      0      0

"
select avg(id) from test
2
select avg(data) from test
0
# test: select min from reference empty
delete from test
select min(id) from test
0
insert into test values (0, 0)
insert into test values (1, 0)
insert into test values (2, 1)
insert into test values (3, 1)
insert into test values (4, 2)
# test: select min from table
select min(id) from test
0
select min(data) from test
0
# test: select max from reference empty
delete from test
select max(id) from test
0
insert into test values (0, 0)
insert into test values (1, 0)
insert into test values (2, 1)
insert into test values (3, 1)
insert into test values (4, 2)
# test: select max from reference
select max(id) from test
4
select max(data) from test
2
# test: select from (select aggr from reference)
explain select * from (select count(*) from test)
"
bytecode [coordinator]
--------
 0                 set        0      0      0
 1               group        1      0      0
 2      group_add_aggr        1      0      0
 3                null        2      0      0
 4                push        2      0      0
 5           group_add        1      0      0
 6             int_min        2      0      0
 7                push        2      0      0
 8         cursor_open        0      0     10      # public.test (primary)
 9                 jmp       14      0      0
10         cursor_read        2      0      0
11                push        2      0      0
12           group_add        1      0      0
13         cursor_next        0     10      0
14        cursor_close        0      0      0
15    cursor_open_expr        1      1     17
16                 jmp       20      0      0
17      group_get_aggr        2      1      0
18             set_add        0      2      0
19         cursor_next        1     17      0
20        cursor_close        1      0      0
21    cursor_open_expr        2      0     23
22                 jmp       26      0      0
23         cursor_read        1      2      0
24                send        1      0      0
25         cursor_next        2     23      0
26        cursor_close        2      0      0
27                recv        0      0      0
28                 ret        0      0      0

"
select * from (select count(*) from test)
5
# test: select aggr from reference group by
explain select id, count(*) from test group by id
"
bytecode [coordinator]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13    cursor_open_expr        1      0     15
14                 jmp       22      0      0
15           group_get        1      1      0
16                push        1      0      0
17      group_get_aggr        1      1      0
18                push        1      0      0
19               array        1      2      0
20                send        1      0      0
21         cursor_next        1     15      0
22        cursor_close        1      0      0
23                recv        0      0      0
24                 ret        0      0      0

"
select id, count(*) from test group by id
[0, 1]
[1, 1]
[2, 1]
[3, 1]
[4, 1]
select data, count(*) from test group by data
[0, 2]
[1, 2]
[2, 1]
# test: select from (select aggr from reference group by)
explain select * from (select id, count(*) from test group by id)
"
bytecode [coordinator]
--------
 0                 set        0      0      0
 1               group        1      1      0
 2      group_add_aggr        1      0      0
 3             int_min        2      0      0
 4                push        2      0      0
 5         cursor_open        0      0      7      # public.test (primary)
 6                 jmp       13      0      0
 7          cursor_idx        2      0      0
 8                push        2      0      0
 9         cursor_read        2      0      0
10                push        2      0      0
11           group_add        1      0      0
12         cursor_next        0      7      0
13        cursor_close        0      0      0
14    cursor_open_expr        1      1     16
15                 jmp       23      0      0
16           group_get        2      1      0
17                push        2      0      0
18      group_get_aggr        2      1      0
19                push        2      0      0
20               array        2      2      0
21             set_add        0      2      0
22         cursor_next        1     16      0
23        cursor_close        1      0      0
24    cursor_open_expr        2      0     26
25                 jmp       29      0      0
26         cursor_read        1      2      0
27                send        1      0      0
28         cursor_next        2     26      0
29        cursor_close        2      0      0
30                recv        0      0      0
31                 ret        0      0      0

"
select * from (select id, count(*) from test group by id)
[0, 1]
[1, 1]
[2, 1]
[3, 1]
[4, 1]
select * from (select data, count(*) from test group by data)
[0, 2]
[1, 2]
[2, 1]
# test: select from reference having label
explain select id, count(*) c from test group by id having c >= 1
"
bytecode [coordinator]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2             int_min        1      0      0
 3                push        1      0      0
 4         cursor_open        0      0      6      # public.test (primary)
 5                 jmp       12      0      0
 6          cursor_idx        1      0      0
 7                push        1      0      0
 8         cursor_read        1      0      0
 9                push        1      0      0
10           group_add        0      0      0
11         cursor_next        0      6      0
12        cursor_close        0      0      0
13    cursor_open_expr        1      0     15
14                 jmp       26      0      0
15      group_get_aggr        1      1      0
16                 int        2      1      0
17                 gte        3      1      2
18                jntr       25      3      0
19           group_get        1      1      0
20                push        1      0      0
21      group_get_aggr        1      1      0
22                push        1      0      0
23               array        1      2      0
24                send        1      0      0
25         cursor_next        1     15      0
26        cursor_close        1      0      0
27                recv        0      0      0
28                 ret        0      0      0

"
select id, count(*) c from test group by id having c >= 1
[0, 1]
[1, 1]
[2, 1]
[3, 1]
[4, 1]
select id, count(*) c from test group by id having c > 1
select data, count(*) c from test group by data having c > 1
[0, 2]
[1, 2]
select data, count(*) c from test group by data having data > 1
[2, 1]
drop table test
# test: select count from expr emtpy
explain select count(*) from []
"
bytecode [coordinator]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5               array        1      0      0
 6    cursor_open_expr        0      1      8
 7                 jmp       12      0      0
 8         cursor_read        2      0      0
 9                push        2      0      0
10           group_add        0      0      0
11         cursor_next        0      8      0
12        cursor_close        0      0      0
13    cursor_open_expr        1      0     15
14                 jmp       18      0      0
15      group_get_aggr        1      1      0
16                send        1      0      0
17         cursor_next        1     15      0
18        cursor_close        1      0      0
19                recv        0      0      0
20                 ret        0      0      0

"
select count(*) from []
0
# test: select count from expr
explain select count(*) from [0,1,2,3,4]
"
bytecode [coordinator]
--------
 0               group        0      0      0
 1      group_add_aggr        0      0      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5                 int        1      0      0
 6                push        1      0      0
 7                 int        1      1      0
 8                push        1      0      0
 9                 int        1      2      0
10                push        1      0      0
11                 int        1      3      0
12                push        1      0      0
13                 int        1      4      0
14                push        1      0      0
15               array        1      5      0
16    cursor_open_expr        0      1     18
17                 jmp       22      0      0
18         cursor_read        2      0      0
19                push        2      0      0
20           group_add        0      0      0
21         cursor_next        0     18      0
22        cursor_close        0      0      0
23    cursor_open_expr        1      0     25
24                 jmp       28      0      0
25      group_get_aggr        1      1      0
26                send        1      0      0
27         cursor_next        1     25      0
28        cursor_close        1      0      0
29                recv        0      0      0
30                 ret        0      0      0

"
select count(*) from [0,1,2,3,4]
5
# test: select sum from expr
explain select sum(*) from [0,1,2,3,4]
"
bytecode [coordinator]
--------
 0               group        0      0      0
 1      group_add_aggr        0      1      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5                 int        1      0      0
 6                push        1      0      0
 7                 int        1      1      0
 8                push        1      0      0
 9                 int        1      2      0
10                push        1      0      0
11                 int        1      3      0
12                push        1      0      0
13                 int        1      4      0
14                push        1      0      0
15               array        1      5      0
16    cursor_open_expr        0      1     18
17                 jmp       22      0      0
18         cursor_read        2      0      0
19                push        2      0      0
20           group_add        0      0      0
21         cursor_next        0     18      0
22        cursor_close        0      0      0
23    cursor_open_expr        1      0     25
24                 jmp       28      0      0
25      group_get_aggr        1      1      0
26                send        1      0      0
27         cursor_next        1     25      0
28        cursor_close        1      0      0
29                recv        0      0      0
30                 ret        0      0      0

"
select sum(*) from [0,1,2,3,4]
10
# test: select avg from expr
explain select avg(*) from [0,1,2,3,4]
"
bytecode [coordinator]
--------
 0               group        0      0      0
 1      group_add_aggr        0      2      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5                 int        1      0      0
 6                push        1      0      0
 7                 int        1      1      0
 8                push        1      0      0
 9                 int        1      2      0
10                push        1      0      0
11                 int        1      3      0
12                push        1      0      0
13                 int        1      4      0
14                push        1      0      0
15               array        1      5      0
16    cursor_open_expr        0      1     18
17                 jmp       22      0      0
18         cursor_read        2      0      0
19                push        2      0      0
20           group_add        0      0      0
21         cursor_next        0     18      0
22        cursor_close        0      0      0
23    cursor_open_expr        1      0     25
24                 jmp       28      0      0
25      group_get_aggr        1      1      0
26                send        1      0      0
27         cursor_next        1     25      0
28        cursor_close        1      0      0
29                recv        0      0      0
30                 ret        0      0      0

"
select avg(*) from [0,1,2,3,4]
2
# test: select min from expr
explain select min(*) from [0,1,2,3,4]
"
bytecode [coordinator]
--------
 0               group        0      0      0
 1      group_add_aggr        0      3      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5                 int        1      0      0
 6                push        1      0      0
 7                 int        1      1      0
 8                push        1      0      0
 9                 int        1      2      0
10                push        1      0      0
11                 int        1      3      0
12                push        1      0      0
13                 int        1      4      0
14                push        1      0      0
15               array        1      5      0
16    cursor_open_expr        0      1     18
17                 jmp       22      0      0
18         cursor_read        2      0      0
19                push        2      0      0
20           group_add        0      0      0
21         cursor_next        0     18      0
22        cursor_close        0      0      0
23    cursor_open_expr        1      0     25
24                 jmp       28      0      0
25      group_get_aggr        1      1      0
26                send        1      0      0
27         cursor_next        1     25      0
28        cursor_close        1      0      0
29                recv        0      0      0
30                 ret        0      0      0

"
select min(*) from [0,1,2,3,4]
0
# test: select max from expr
explain select max(*) from [0,1,2,3,4]
"
bytecode [coordinator]
--------
 0               group        0      0      0
 1      group_add_aggr        0      4      0
 2                null        1      0      0
 3                push        1      0      0
 4           group_add        0      0      0
 5                 int        1      0      0
 6                push        1      0      0
 7                 int        1      1      0
 8                push        1      0      0
 9                 int        1      2      0
10                push        1      0      0
11                 int        1      3      0
12                push        1      0      0
13                 int        1      4      0
14                push        1      0      0
15               array        1      5      0
16    cursor_open_expr        0      1     18
17                 jmp       22      0      0
18         cursor_read        2      0      0
19                push        2      0      0
20           group_add        0      0      0
21         cursor_next        0     18      0
22        cursor_close        0      0      0
23    cursor_open_expr        1      0     25
24                 jmp       28      0      0
25      group_get_aggr        1      1      0
26                send        1      0      0
27         cursor_next        1     25      0
28        cursor_close        1      0      0
29                recv        0      0      0
30                 ret        0      0      0

"
select max(*) from [0,1,2,3,4]
4
# test: select from (select aggr from expr)
explain select * from (select count(*) from [0,1,2,3,4])
"
bytecode [coordinator]
--------
 0                 set        0      0      0
 1               group        1      0      0
 2      group_add_aggr        1      0      0
 3                null        2      0      0
 4                push        2      0      0
 5           group_add        1      0      0
 6                 int        2      0      0
 7                push        2      0      0
 8                 int        2      1      0
 9                push        2      0      0
10                 int        2      2      0
11                push        2      0      0
12                 int        2      3      0
13                push        2      0      0
14                 int        2      4      0
15                push        2      0      0
16               array        2      5      0
17    cursor_open_expr        0      2     19
18                 jmp       23      0      0
19         cursor_read        3      0      0
20                push        3      0      0
21           group_add        1      0      0
22         cursor_next        0     19      0
23        cursor_close        0      0      0
24    cursor_open_expr        1      1     26
25                 jmp       29      0      0
26      group_get_aggr        2      1      0
27             set_add        0      2      0
28         cursor_next        1     26      0
29        cursor_close        1      0      0
30    cursor_open_expr        2      0     32
31                 jmp       35      0      0
32         cursor_read        1      2      0
33                send        1      0      0
34         cursor_next        2     32      0
35        cursor_close        2      0      0
36                recv        0      0      0
37                 ret        0      0      0

"
select * from (select count(*) from [0,1,2,3,4])
5
# test: select aggr from expr group by
explain select *, count(*) from [0,1,2,3,4] group by *
"
bytecode [coordinator]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2                 int        1      0      0
 3                push        1      0      0
 4                 int        1      1      0
 5                push        1      0      0
 6                 int        1      2      0
 7                push        1      0      0
 8                 int        1      3      0
 9                push        1      0      0
10                 int        1      4      0
11                push        1      0      0
12               array        1      5      0
13    cursor_open_expr        0      1     15
14                 jmp       21      0      0
15         cursor_read        2      0      0
16                push        2      0      0
17         cursor_read        2      0      0
18                push        2      0      0
19           group_add        0      0      0
20         cursor_next        0     15      0
21        cursor_close        0      0      0
22    cursor_open_expr        1      0     24
23                 jmp       31      0      0
24         cursor_read        1      1      0
25                push        1      0      0
26      group_get_aggr        1      1      0
27                push        1      0      0
28               array        1      2      0
29                send        1      0      0
30         cursor_next        1     24      0
31        cursor_close        1      0      0
32                recv        0      0      0
33                 ret        0      0      0

"
select *, count(*) from [0,1,2,3,4] group by *
[0, 1]
[1, 1]
[2, 1]
[3, 1]
[4, 1]
# test: select from (select aggr from expr group by)
explain select * from (select *, count(*) from [0,1,2,3,4] group by *)
"
bytecode [coordinator]
--------
 0                 set        0      0      0
 1               group        1      1      0
 2      group_add_aggr        1      0      0
 3                 int        2      0      0
 4                push        2      0      0
 5                 int        2      1      0
 6                push        2      0      0
 7                 int        2      2      0
 8                push        2      0      0
 9                 int        2      3      0
10                push        2      0      0
11                 int        2      4      0
12                push        2      0      0
13               array        2      5      0
14    cursor_open_expr        0      2     16
15                 jmp       22      0      0
16         cursor_read        3      0      0
17                push        3      0      0
18         cursor_read        3      0      0
19                push        3      0      0
20           group_add        1      0      0
21         cursor_next        0     16      0
22        cursor_close        0      0      0
23    cursor_open_expr        1      1     25
24                 jmp       32      0      0
25         cursor_read        2      1      0
26                push        2      0      0
27      group_get_aggr        2      1      0
28                push        2      0      0
29               array        2      2      0
30             set_add        0      2      0
31         cursor_next        1     25      0
32        cursor_close        1      0      0
33    cursor_open_expr        2      0     35
34                 jmp       38      0      0
35         cursor_read        1      2      0
36                send        1      0      0
37         cursor_next        2     35      0
38        cursor_close        2      0      0
39                recv        0      0      0
40                 ret        0      0      0

"
select * from (select *, count(*) from [0,1,2,3,4] group by *)
[0, 1]
[1, 1]
[2, 1]
[3, 1]
[4, 1]
# test: select from expr having label
explain select *, count(*) c from [0,1,2,3,4] group by * having c >= 1
"
bytecode [coordinator]
--------
 0               group        0      1      0
 1      group_add_aggr        0      0      0
 2                 int        1      0      0
 3                push        1      0      0
 4                 int        1      1      0
 5                push        1      0      0
 6                 int        1      2      0
 7                push        1      0      0
 8                 int        1      3      0
 9                push        1      0      0
10                 int        1      4      0
11                push        1      0      0
12               array        1      5      0
13    cursor_open_expr        0      1     15
14                 jmp       21      0      0
15         cursor_read        2      0      0
16                push        2      0      0
17         cursor_read        2      0      0
18                push        2      0      0
19           group_add        0      0      0
20         cursor_next        0     15      0
21        cursor_close        0      0      0
22    cursor_open_expr        1      0     24
23                 jmp       35      0      0
24      group_get_aggr        1      1      0
25                 int        2      1      0
26                 gte        3      1      2
27                jntr       34      3      0
28         cursor_read        1      1      0
29                push        1      0      0
30      group_get_aggr        1      1      0
31                push        1      0      0
32               array        1      2      0
33                send        1      0      0
34         cursor_next        1     24      0
35        cursor_close        1      0      0
36                recv        0      0      0
37                 ret        0      0      0

"
select *, count(*) c from [0,1,2,3,4] group by * having c >= 1
[0, 1]
[1, 1]
[2, 1]
[3, 1]
[4, 1]
disconnect S0
env_close E0
