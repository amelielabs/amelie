#

open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }];
connect E0 S0 127.0.0.1:3485;

# test: select distinct from expr
select distinct it from ([1,2,3,1,2]) it;

# test: select count(distinct) from expr
explain select count(distinct it) from ([1,2,3]) it;

select count(it) from ([1,2,3]) it;
select count(distinct it) from ([1,2,3]) it;

select count(it) from ([1,2,3,3]) it;
select count(distinct it) from ([1,2,3,3]) it;

select count(it) from ([1,2,3,1]) it;
select count(distinct it) from ([1,2,3,1]) it;

select count(it) from ([1,2,3,1,2]) it;
select count(distinct it) from ([1,2,3,1,2]) it;

# test: select count(distinct) from expr group by
explain select count(distinct it) from ([1,2,3]) it group by it;

select count(it) from ([1,2,3]) it group by it;
select count(distinct it) from ([1,2,3]) it group by it;

select count(it) from ([1,2,3]) it group by it;
select count(distinct it) from ([1,2,3]) it group by it;

select count(it) from ([1,2,3,3]) it group by it;
select count(distinct it) from ([1,2,3,3]) it group by it;

select count(it) from ([1,2,3,1]) it group by it;
select count(distinct it) from ([1,2,3,1]) it group by it;

select count(it) from ([1,2,3,1,2]) it group by it;
select count(distinct it) from ([1,2,3,1,2]) it group by it;

# test: select count(distinct) from expr group by order by
explain select count(distinct it) from ([1,2,3]) it group by it order by 1;

select count(it) from ([1,2,3]) it group by it order by 1;
select count(distinct it) from ([1,2,3]) it group by it order by 1;

select count(it) from ([1,2,3]) it group by it order by 1;
select count(distinct it) from ([1,2,3]) it group by it order by 1;

select count(it) from ([1,2,3,3]) it group by it order by 1;
select count(distinct it) from ([1,2,3,3]) it group by it order by 1;

select count(it) from ([1,2,3,1]) it group by it order by 1;
select count(distinct it) from ([1,2,3,1]) it group by it order by 1;

select count(it) from ([1,2,3,1,2]) it group by it order by 1;
select count(distinct it) from ([1,2,3,1,2]) it group by it order by 1;

# test: select count(distinct) from expr order by
explain select count(distinct it) from ([1,2,3]) it order by 1;
select count(it) from ([1,2,3,1,2]) it order by 1;
select count(distinct it) from ([1,2,3,1,2]) it order by 1;

# test: select (select count(distinct))
select (select count(distinct it) from ([1,2,3,1,2]) it);

## test: select (select distinct)
#explain select (select distinct it from ([1,2,3,1,2]) it);
#select (select distinct it from ([1,2,3,1,2]) it);

disconnect S0;
close E0;
