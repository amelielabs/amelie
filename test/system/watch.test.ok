open E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }]
connect E0 S0 localhost:3485
# test: watch parsing
watch
{"code": 1, "msg": "bad expression"}
# test: watch
show lsn
[1]
explain watch system.config().lsn = 1
[{
  "bytecode": {
    "coordinator": {
      "00": "call                0      -      0     # system.config()",
      "01": "string              1      0      0     # lsn",
      "02": "idx                 2      0      1     ",
      "03": "int                 0      -      0     # 1",
      "04": "equ                 1      2      0     ",
      "05": "jtr                 8      1      0     ",
      "06": "sleep               1000   0      0     ",
      "07": "jmp                 0      0      0     ",
      "08": "nop                 0      0      0     ",
      "09": "array               0      0      0     ",
      "10": "cte_set             0      0      0     ",
      "11": "body                0      0      0     ",
      "12": "ret                 0      0      0     "
    }
  }
}]
watch system.config().lsn = 1
[]
# test: watch subquery
explain watch (select 123) = 123
[{
  "bytecode": {
    "coordinator": {
      "00": "int                 0      -      0     # 123",
      "01": "int                 1      -      0     # 123",
      "02": "equ                 2      0      1     ",
      "03": "jtr                 6      2      0     ",
      "04": "sleep               1000   0      0     ",
      "05": "jmp                 0      0      0     ",
      "06": "nop                 0      0      0     ",
      "07": "array               0      0      0     ",
      "08": "cte_set             0      0      0     ",
      "09": "body                0      0      0     ",
      "10": "ret                 0      0      0     "
    }
  }
}]
watch (select 123) = 123
[]
create table test (id int primary key serial)
[]
watch select * from test
{"code": 1, "msg": "WATCH: sub queries are not supported"}
disconnect S0
close E0
