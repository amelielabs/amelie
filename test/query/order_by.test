#

env_open E0
connect E0 S0

# test: order by []
select * from [1,3,2] order
select * from [1,3,2] order by
select * from [1,3,2] order by *
explain select * from [1,3,2] order by *
select * from 1 order by *
select * from 1 order by *
select (select * from [1,3,2] order by *)
select * from (select * from [1,3,2] order by *)

# test: order by {}
select * from {"a": 1, "b": 3, "c": 2} order by *
select (select * from {"a": 1, "b": 3, "c": 2} order by *)
select * from (select * from {"a": 1, "b": 3, "c": 2} order by *)

select **, * from {"a": 1, "b": 3, "c": 2} order by **
select **, * from {"b": 3, "a": 1, "c": 2} order by **

# test: order by asc
select * from [1,3,2] order by * asc

# test: order by desc
select * from [1,3,2] order by * desc

# test: order by column
create table test (id int primary key, data int)
insert into test values (1, 1)
insert into test values (2, 3)
insert into test values (3, 2)

explain select * from test order by data
select * from test order by data

# test: order by column asc
select * from test order by data asc

# test: order by column desc
select * from test order by data desc

# test: order by column type
select * from test order by data
select * from test order by data asc

# test: order by target.column
select * from test order by test.data
select * from test order by test

# test: order by alias.column
select * from test alias order by alias.data

# test: order by compound
select * from test order by data, id
select * from test order by data desc, id
select * from test order by id, data
select * from test order by id desc, data

drop table test

disconnect S0
env_close E0
