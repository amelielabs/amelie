#

start E0 "uuid": "00000000-0000-0000-0000-000000000000", "listen": [{ "host": "127.0.0.1", "port": 3485 }]
connect E0 S0 localhost:3485

# test: select from expr where
explain select * from [1, 2, 3] where true
select * from [1, 2, 3] where true
select * from [1, 2, 3] where false

# test: select from expr where #2
select ** from {"a": 1, "b": 2, "c": 3} where true
select ** from {"a": 1, "b": 2, "c": 3} where false
select ** from {} where true

# test: select from expr where star
select * from [1, 2, 3] where * = 2
select * from [1, 2, 3] where * >= 2
select * from [1, 2, 3] where * <> 2

# test: select from expr where star #2
select ** from {"a": 1, "b": 2, "c": 3} where * = 2
select ** from {"a": 1, "b": 2, "c": 3} where * >= 2
select ** from {"a": 1, "b": 2, "c": 3} where * <> 2
select * from [] where true

# test: select from table where star
create table test (id int primary key serial, data int default 0)
insert into test () values ()
insert into test () values ()
insert into test () values ()
explain select * from test where *[0] >= 0
select * from test where *[0] >= 0
drop table test

# test: select from table where column
create table test (id int primary key serial, data int default 0)
insert into test () values ()
insert into test () values ()
insert into test () values ()
explain select * from test where id >= 0
select * from test where id >= 0
drop table test

# test: select from table where column.path
create table test (id int primary key serial, data object)
insert into test (data) values ({"data": 123})
insert into test (data) values ({"data": 123})
insert into test (data) values ({"data": 123})
select * from test
explain select * from test where data.data >= 0
select * from test where data.data >= 0
drop table test

# test: select from table where column.path #2
create table test (id int primary key serial, data object)
insert into test (data) values ({"data": {"data": 123}})
insert into test (data) values ({"data": {"data": 123}})
insert into test (data) values ({"data": {"data": 123}})
select * from test
explain select * from test where data.data.data >= 0
select * from test where data.data.data >= 0
drop table test

# test: select from table where target.column
create table test (id int primary key serial, data int default 0)
insert into test () values ()
insert into test () values ()
insert into test () values ()
explain select * from test where test.id >= 0
select * from test where test.id >= 0
drop table test

# test: select from table where target.column.path
create table test (id int primary key serial, data object)
insert into test (data) values ({"data": 123})
insert into test (data) values ({"data": 123})
insert into test (data) values ({"data": 123})
explain select * from test where test.data.data >= 0
select * from test where test.data.data >= 0
drop table test

# test: select from table where alias.column
create table test (id int primary key serial, data int default 0)
insert into test () values ()
insert into test () values ()
insert into test () values ()
explain select * from test alias where alias.id >= 0
select * from test alias where alias.id >= 0
drop table test

# test: select from table where alias.column.path
create table test (id int primary key serial, data object)
insert into test (data) values ({"data": 123})
insert into test (data) values ({"data": 123})
insert into test (data) values ({"data": 123})
explain select * from test alias where alias.data.data >= 0
select * from test alias where alias.data.data >= 0
drop table test

# test: where true/false
create table test (id int primary key)
insert into test values (1), (2), (3)
explain select * from test where true
select * from test where true
select * from test where false
drop table test

# test: where gte
create table test (id int primary key)
insert into test values (1), (2), (3)
explain select * from test where id >= 0
select * from test where id >= 0
select * from test where id >= 1
select * from test where id >= 2
select * from test where id >= 3
select * from test where id >= 4

# test: where gt
select * from test where id > 0
select * from test where id > 1
select * from test where id > 2
select * from test where id > 3
select * from test where id > 9

# test: where lte
explain select * from test where id <= 0
select * from test where id <= 0
select * from test where id <= 1
select * from test where id <= 2
select * from test where id <= 3
select * from test where id <= 8

# test: where lt
explain select * from test where id < 0
select * from test where id < 0
select * from test where id < 1
select * from test where id < 2
select * from test where id < 3
select * from test where id < 8
drop table test

# test: where point lookup
create table test (id int primary key)
insert into test values (1), (2), (3)
select * from test where id = 2
drop table test

# test: where point lookup nested
create table test (obj object, primary key(obj.id int))
insert into test {"id": 1}
insert into test {"id": 2}
insert into test {"id": 3}
select * from test where obj.id = 2
drop table test

disconnect S0
stop E0
