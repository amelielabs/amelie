#

env_open E0
connect E0 S0

# test: drop table statement parsing
drop
drop 1
drop table "name"
drop table name junk

# test: drop non-existing table
drop table name
drop table if exists test

# test: drop table
create table test(id int primary key)
select name from mn_tables()
drop table test
select name from mn_tables()

# test: drop table if exists
create table test(id int primary key)
select name from mn_tables()
drop table test
select name from mn_tables()
drop table if exists test
drop table if exists test.test

# test: recreate same table after drop
create table test (id int primary key)
select name from mn_tables()
drop table test
create table test (id int primary key)
select name from mn_tables()
drop table test

# test: drop table schema
create schema test
create table test.test (id int primary key)
select name from mn_tables() where *.schema = "test" and name = "test"
drop table test
drop table test.test
drop schema test
select name from mn_tables() where *.schema = "test" and name = "test"

disconnect S0
env_close E0
