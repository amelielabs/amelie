#

env_open E0
connect E0 S0

# test: drop schema with dependency
create schema test
create table test.a(id int primary key)
create table test.b(id int primary key)
drop schema test
select *.schema, *.name from system.tables()

create view test.test_view as select 1
select * from system.views()

# test: drop schema cascade
drop schema test cascade
select * from system.schemas()

# test: drop schema cascade (tables)
select *.schema, *.name from system.tables()

# test: drop schema cascade (views)
select * from system.views()

create schema test
create table test.a(id int primary key)
create table test.b(id int primary key)
drop schema test cascade
select *.schema, *.name from system.tables()

# test: alter schema rename
create schema test

create table test.a(id int primary key)
create table test.b(id int primary key)
select * from system.schemas()
select *.schema, *.name from system.tables()

alter schema test rename test2
select * from system.schemas()
select *.schema, *.name from system.tables()

disconnect S0
env_close E0
