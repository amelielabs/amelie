env_open E0 "cluster_shards": 3
connect E0 S0
connect: on_connect
create table ref (id int primary key, data int default 0) reference
insert into ref (id) values (1), (2), (3)
create table test (id int primary key, data int default 0)
insert into test (id) values (1), (2), (3)
# test: select from table, expr
explain select test.*, t.* from test, [1,2,3] t
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       22      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       20      0      0
13         cursor_read        1      0      0
14                push        1      0      0
15         cursor_read        1      1      0
16                push        1      0      0
17               array        1      2      0
18                send        1      0      0
19         cursor_next        1     13      0
20        cursor_close        1      0      0
21         cursor_next        0      4      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0


bytecode [shard 1]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       22      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       20      0      0
13         cursor_read        1      0      0
14                push        1      0      0
15         cursor_read        1      1      0
16                push        1      0      0
17               array        1      2      0
18                send        1      0      0
19         cursor_next        1     13      0
20        cursor_close        1      0      0
21         cursor_next        0      4      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0


bytecode [shard 2]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       22      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       20      0      0
13         cursor_read        1      0      0
14                push        1      0      0
15         cursor_read        1      1      0
16                push        1      0      0
17               array        1      2      0
18                send        1      0      0
19         cursor_next        1     13      0
20        cursor_close        1      0      0
21         cursor_next        0      4      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0

"
select test.*, t.* from test, [1,2,3] t
[[3, 0], 1]
[[2, 0], 1]
[[1, 0], 1]
[[3, 0], 2]
[[2, 0], 2]
[[1, 0], 2]
[[3, 0], 3]
[[2, 0], 3]
[[1, 0], 3]
# test: select from expr, table
explain select test.*, t.* from [1,2,3] t, test
query: on_error
{"code": 1, "msg": "FROM: undefined distributed table"}
select test.*, t.* from [1,2,3] t, test
query: on_error
{"code": 1, "msg": "FROM: undefined distributed table"}
# test: select from table, reference
explain select test.*, ref.* from test, ref
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       17      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       15      0      0
 8         cursor_read        0      0      0
 9                push        0      0      0
10         cursor_read        0      1      0
11                push        0      0      0
12               array        0      2      0
13                send        0      0      0
14         cursor_next        1      8      0
15        cursor_close        1      0      0
16         cursor_next        0      4      0
17        cursor_close        0      0      0
18               ready        0     -1      0
19                 ret        0      0      0


bytecode [shard 1]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       17      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       15      0      0
 8         cursor_read        0      0      0
 9                push        0      0      0
10         cursor_read        0      1      0
11                push        0      0      0
12               array        0      2      0
13                send        0      0      0
14         cursor_next        1      8      0
15        cursor_close        1      0      0
16         cursor_next        0      4      0
17        cursor_close        0      0      0
18               ready        0     -1      0
19                 ret        0      0      0


bytecode [shard 2]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       17      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       15      0      0
 8         cursor_read        0      0      0
 9                push        0      0      0
10         cursor_read        0      1      0
11                push        0      0      0
12               array        0      2      0
13                send        0      0      0
14         cursor_next        1      8      0
15        cursor_close        1      0      0
16         cursor_next        0      4      0
17        cursor_close        0      0      0
18               ready        0     -1      0
19                 ret        0      0      0

"
select test.*, ref.* from test, ref
[[3, 0], [1, 0]]
[[2, 0], [1, 0]]
[[1, 0], [1, 0]]
[[3, 0], [2, 0]]
[[2, 0], [2, 0]]
[[1, 0], [2, 0]]
[[3, 0], [3, 0]]
[[2, 0], [3, 0]]
[[1, 0], [3, 0]]
# test: select from reference, table
explain select test.*, ref.* from ref, test
query: on_error
{"code": 1, "msg": "primary distributed table cannot be a reference table"}
select test.*, ref.* from ref, test
query: on_error
{"code": 1, "msg": "primary distributed table cannot be a reference table"}
# test: select from table, table
explain select t.* from test, test t
query: on_error
{"code": 1, "msg": "subqueries to distributed tables are not supported"}
select t.* from test, test t
query: on_error
{"code": 1, "msg": "subqueries to distributed tables are not supported"}
# test: select from table join expr
explain select test.*, t.* from test join [1,2,3] t
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       22      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       20      0      0
13         cursor_read        1      0      0
14                push        1      0      0
15         cursor_read        1      1      0
16                push        1      0      0
17               array        1      2      0
18                send        1      0      0
19         cursor_next        1     13      0
20        cursor_close        1      0      0
21         cursor_next        0      4      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0


bytecode [shard 1]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       22      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       20      0      0
13         cursor_read        1      0      0
14                push        1      0      0
15         cursor_read        1      1      0
16                push        1      0      0
17               array        1      2      0
18                send        1      0      0
19         cursor_next        1     13      0
20        cursor_close        1      0      0
21         cursor_next        0      4      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0


bytecode [shard 2]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       22      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       20      0      0
13         cursor_read        1      0      0
14                push        1      0      0
15         cursor_read        1      1      0
16                push        1      0      0
17               array        1      2      0
18                send        1      0      0
19         cursor_next        1     13      0
20        cursor_close        1      0      0
21         cursor_next        0      4      0
22        cursor_close        0      0      0
23               ready        0     -1      0
24                 ret        0      0      0

"
select test.*, t.* from test join [1,2,3] t
[[3, 0], 1]
[[2, 0], 1]
[[1, 0], 1]
[[3, 0], 2]
[[2, 0], 2]
[[1, 0], 2]
[[3, 0], 3]
[[2, 0], 3]
[[1, 0], 3]
# test: select from table join expr on
explain select test.id, t.* from test join [1,2,3] t on (test.id = t.*)
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       26      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       24      0      0
13          cursor_idx        1      0      0
14         cursor_read        2      1      0
15                 equ        3      1      2
16                jntr       23      3      0
17          cursor_idx        1      0      0
18                push        1      0      0
19         cursor_read        1      1      0
20                push        1      0      0
21               array        1      2      0
22                send        1      0      0
23         cursor_next        1     13      0
24        cursor_close        1      0      0
25         cursor_next        0      4      0
26        cursor_close        0      0      0
27               ready        0     -1      0
28                 ret        0      0      0


bytecode [shard 1]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       26      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       24      0      0
13          cursor_idx        1      0      0
14         cursor_read        2      1      0
15                 equ        3      1      2
16                jntr       23      3      0
17          cursor_idx        1      0      0
18                push        1      0      0
19         cursor_read        1      1      0
20                push        1      0      0
21               array        1      2      0
22                send        1      0      0
23         cursor_next        1     13      0
24        cursor_close        1      0      0
25         cursor_next        0      4      0
26        cursor_close        0      0      0
27               ready        0     -1      0
28                 ret        0      0      0


bytecode [shard 2]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       26      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       24      0      0
13          cursor_idx        1      0      0
14         cursor_read        2      1      0
15                 equ        3      1      2
16                jntr       23      3      0
17          cursor_idx        1      0      0
18                push        1      0      0
19         cursor_read        1      1      0
20                push        1      0      0
21               array        1      2      0
22                send        1      0      0
23         cursor_next        1     13      0
24        cursor_close        1      0      0
25         cursor_next        0      4      0
26        cursor_close        0      0      0
27               ready        0     -1      0
28                 ret        0      0      0

"
select test.id, t.* from test join [1,2,3] t on (test.id = t.*)
[3, 3]
[2, 2]
[1, 1]
# test: select from table join expr on #2
explain select test.id, t.*, t2.* from test join [1,2,3] t join [3,2,1] t2 on (test.id = t.* = t2.*)
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       41      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       39      0      0
13                 int        1      3      0
14                push        1      0      0
15                 int        1      2      0
16                push        1      0      0
17                 int        1      1      0
18                push        1      0      0
19               array        1      3      0
20    cursor_open_expr        2      1     22
21                 jmp       37      0      0
22          cursor_idx        2      0      0
23         cursor_read        3      1      0
24                 equ        4      2      3
25         cursor_read        2      2      0
26                 equ        3      4      2
27                jntr       36      3      0
28          cursor_idx        2      0      0
29                push        2      0      0
30         cursor_read        2      1      0
31                push        2      0      0
32         cursor_read        2      2      0
33                push        2      0      0
34               array        2      3      0
35                send        2      0      0
36         cursor_next        2     22      0
37        cursor_close        2      0      0
38         cursor_next        1     13      0
39        cursor_close        1      0      0
40         cursor_next        0      4      0
41        cursor_close        0      0      0
42               ready        0     -1      0
43                 ret        0      0      0


bytecode [shard 1]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       41      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       39      0      0
13                 int        1      3      0
14                push        1      0      0
15                 int        1      2      0
16                push        1      0      0
17                 int        1      1      0
18                push        1      0      0
19               array        1      3      0
20    cursor_open_expr        2      1     22
21                 jmp       37      0      0
22          cursor_idx        2      0      0
23         cursor_read        3      1      0
24                 equ        4      2      3
25         cursor_read        2      2      0
26                 equ        3      4      2
27                jntr       36      3      0
28          cursor_idx        2      0      0
29                push        2      0      0
30         cursor_read        2      1      0
31                push        2      0      0
32         cursor_read        2      2      0
33                push        2      0      0
34               array        2      3      0
35                send        2      0      0
36         cursor_next        2     22      0
37        cursor_close        2      0      0
38         cursor_next        1     13      0
39        cursor_close        1      0      0
40         cursor_next        0      4      0
41        cursor_close        0      0      0
42               ready        0     -1      0
43                 ret        0      0      0


bytecode [shard 2]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       41      0      0
 4                 int        0      1      0
 5                push        0      0      0
 6                 int        0      2      0
 7                push        0      0      0
 8                 int        0      3      0
 9                push        0      0      0
10               array        0      3      0
11    cursor_open_expr        1      0     13
12                 jmp       39      0      0
13                 int        1      3      0
14                push        1      0      0
15                 int        1      2      0
16                push        1      0      0
17                 int        1      1      0
18                push        1      0      0
19               array        1      3      0
20    cursor_open_expr        2      1     22
21                 jmp       37      0      0
22          cursor_idx        2      0      0
23         cursor_read        3      1      0
24                 equ        4      2      3
25         cursor_read        2      2      0
26                 equ        3      4      2
27                jntr       36      3      0
28          cursor_idx        2      0      0
29                push        2      0      0
30         cursor_read        2      1      0
31                push        2      0      0
32         cursor_read        2      2      0
33                push        2      0      0
34               array        2      3      0
35                send        2      0      0
36         cursor_next        2     22      0
37        cursor_close        2      0      0
38         cursor_next        1     13      0
39        cursor_close        1      0      0
40         cursor_next        0      4      0
41        cursor_close        0      0      0
42               ready        0     -1      0
43                 ret        0      0      0

"
select test.id, t.*, t2.* from test join [1,2,3] t join [3,2,1] t2 on (test.id = t.* = t2.*)
[3, 3, 1]
[2, 2, 1]
[1, 1, 1]
# test: select from table join reference
explain select test.id, ref.id from test join ref
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       17      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       15      0      0
 8          cursor_idx        0      0      0
 9                push        0      0      0
10          cursor_idx        0      1      0
11                push        0      0      0
12               array        0      2      0
13                send        0      0      0
14         cursor_next        1      8      0
15        cursor_close        1      0      0
16         cursor_next        0      4      0
17        cursor_close        0      0      0
18               ready        0     -1      0
19                 ret        0      0      0


bytecode [shard 1]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       17      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       15      0      0
 8          cursor_idx        0      0      0
 9                push        0      0      0
10          cursor_idx        0      1      0
11                push        0      0      0
12               array        0      2      0
13                send        0      0      0
14         cursor_next        1      8      0
15        cursor_close        1      0      0
16         cursor_next        0      4      0
17        cursor_close        0      0      0
18               ready        0     -1      0
19                 ret        0      0      0


bytecode [shard 2]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       17      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       15      0      0
 8          cursor_idx        0      0      0
 9                push        0      0      0
10          cursor_idx        0      1      0
11                push        0      0      0
12               array        0      2      0
13                send        0      0      0
14         cursor_next        1      8      0
15        cursor_close        1      0      0
16         cursor_next        0      4      0
17        cursor_close        0      0      0
18               ready        0     -1      0
19                 ret        0      0      0

"
select test.id, ref.id from test join ref
[3, 1]
[2, 1]
[1, 1]
[3, 2]
[2, 2]
[1, 2]
[3, 3]
[2, 3]
[1, 3]
# test: select from table join reference on
explain select test.id, ref.id from test join ref on (test.id = ref.id)
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       21      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       19      0      0
 8          cursor_idx        0      0      0
 9          cursor_idx        1      1      0
10                 equ        2      0      1
11                jntr       18      2      0
12          cursor_idx        0      0      0
13                push        0      0      0
14          cursor_idx        0      1      0
15                push        0      0      0
16               array        0      2      0
17                send        0      0      0
18         cursor_next        1      8      0
19        cursor_close        1      0      0
20         cursor_next        0      4      0
21        cursor_close        0      0      0
22               ready        0     -1      0
23                 ret        0      0      0


bytecode [shard 1]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       21      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       19      0      0
 8          cursor_idx        0      0      0
 9          cursor_idx        1      1      0
10                 equ        2      0      1
11                jntr       18      2      0
12          cursor_idx        0      0      0
13                push        0      0      0
14          cursor_idx        0      1      0
15                push        0      0      0
16               array        0      2      0
17                send        0      0      0
18         cursor_next        1      8      0
19        cursor_close        1      0      0
20         cursor_next        0      4      0
21        cursor_close        0      0      0
22               ready        0     -1      0
23                 ret        0      0      0


bytecode [shard 2]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       21      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       19      0      0
 8          cursor_idx        0      0      0
 9          cursor_idx        1      1      0
10                 equ        2      0      1
11                jntr       18      2      0
12          cursor_idx        0      0      0
13                push        0      0      0
14          cursor_idx        0      1      0
15                push        0      0      0
16               array        0      2      0
17                send        0      0      0
18         cursor_next        1      8      0
19        cursor_close        1      0      0
20         cursor_next        0      4      0
21        cursor_close        0      0      0
22               ready        0     -1      0
23                 ret        0      0      0

"
select test.id, ref.id from test join ref on (test.id = ref.id)
[3, 3]
[2, 2]
[1, 1]
# test: select from table join reference on #2
explain select test.id, ref.id from test join ref on (test.id = ref.id) join ref ref2 on (test.id = ref2.id)
"
bytecode [coordinator]
--------
 0                recv        0      0      0
 1                 ret        0      0      0


bytecode [shard 0]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       36      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       34      0      0
 8             int_min        0      0      0
 9                push        0      0      0
10         cursor_open        2     39     12      # public.ref (primary)
11                 jmp       32      0      0
12          cursor_idx        1      0      0
13          cursor_idx        2      1      0
14                 equ        3      1      2
15                jntr       20      3      0
16          cursor_idx        1      0      0
17          cursor_idx        2      2      0
18                 equ        4      1      2
19                 jtr       22      4      0
20                bool        0      0      0
21                 jmp       23      0      0
22                bool        0      1      0
23                 nop        0      0      0
24                jntr       31      0      0
25          cursor_idx        0      0      0
26                push        0      0      0
27          cursor_idx        0      1      0
28                push        0      0      0
29               array        0      2      0
30                send        0      0      0
31         cursor_next        2     12      0
32        cursor_close        2      0      0
33         cursor_next        1      8      0
34        cursor_close        1      0      0
35         cursor_next        0      4      0
36        cursor_close        0      0      0
37               ready        0     -1      0
38                 ret        0      0      0


bytecode [shard 1]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       36      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       34      0      0
 8             int_min        0      0      0
 9                push        0      0      0
10         cursor_open        2     39     12      # public.ref (primary)
11                 jmp       32      0      0
12          cursor_idx        1      0      0
13          cursor_idx        2      1      0
14                 equ        3      1      2
15                jntr       20      3      0
16          cursor_idx        1      0      0
17          cursor_idx        2      2      0
18                 equ        4      1      2
19                 jtr       22      4      0
20                bool        0      0      0
21                 jmp       23      0      0
22                bool        0      1      0
23                 nop        0      0      0
24                jntr       31      0      0
25          cursor_idx        0      0      0
26                push        0      0      0
27          cursor_idx        0      1      0
28                push        0      0      0
29               array        0      2      0
30                send        0      0      0
31         cursor_next        2     12      0
32        cursor_close        2      0      0
33         cursor_next        1      8      0
34        cursor_close        1      0      0
35         cursor_next        0      4      0
36        cursor_close        0      0      0
37               ready        0     -1      0
38                 ret        0      0      0


bytecode [shard 2]
--------
 0             int_min        0      0      0
 1                push        0      0      0
 2         cursor_open        0      0      4      # public.test (primary)
 3                 jmp       36      0      0
 4             int_min        0      0      0
 5                push        0      0      0
 6         cursor_open        1     20      8      # public.ref (primary)
 7                 jmp       34      0      0
 8             int_min        0      0      0
 9                push        0      0      0
10         cursor_open        2     39     12      # public.ref (primary)
11                 jmp       32      0      0
12          cursor_idx        1      0      0
13          cursor_idx        2      1      0
14                 equ        3      1      2
15                jntr       20      3      0
16          cursor_idx        1      0      0
17          cursor_idx        2      2      0
18                 equ        4      1      2
19                 jtr       22      4      0
20                bool        0      0      0
21                 jmp       23      0      0
22                bool        0      1      0
23                 nop        0      0      0
24                jntr       31      0      0
25          cursor_idx        0      0      0
26                push        0      0      0
27          cursor_idx        0      1      0
28                push        0      0      0
29               array        0      2      0
30                send        0      0      0
31         cursor_next        2     12      0
32        cursor_close        2      0      0
33         cursor_next        1      8      0
34        cursor_close        1      0      0
35         cursor_next        0      4      0
36        cursor_close        0      0      0
37               ready        0     -1      0
38                 ret        0      0      0

"
select test.id, ref.id from test join ref on (test.id = ref.id) join ref ref2 on (test.id = ref2.id)
[3, 3]
[2, 2]
[1, 1]
drop table ref
drop table test
disconnect S0
env_close E0
