#

env_open E0 "cluster_shards": 3
connect E0 S0

create table a (id int primary key, data int default 0)
create table b (id int primary key, data int default 0)

create table ref (id int primary key, data int default 0) reference
insert into ref values (0, 8), (1, 8), (2, 8);

# test: begin
begin

# test: begin begin
begin; begin

# test: commit
commit; begin

# test: begin commit
begin; commit
explain begin; commit
explain

# test: begin commit commit
begin; commit; commit

# test: begin commit insert
begin; commit; insert into a (id) values (0), (1), (2), (3)
select * from a

# test: begin insert
begin; insert into a (id) values (0), (1), (2), (3)
select * from a

# test: begin insert commit
explain begin; insert into a (id) values (0), (1), (2), (3); commit
begin; insert into a (id) values (0), (1), (2), (3); commit
select * from a

drop table a
drop table b
drop table ref

disconnect S0
env_close E0
